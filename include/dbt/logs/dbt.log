[0m17:35:24.939792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd9b7af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd94fde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd94fec60>]}


============================== 17:35:24.944361 | 3ec62c43-0519-4efd-9066-19943cf12970 ==============================
[0m17:35:24.944361 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:35:24.945383 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps', 'quiet': 'False', 'introspect': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/astro/.dbt', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'debug': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default'}
[0m17:35:25.118875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ec62c43-0519-4efd-9066-19943cf12970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd9bff080>]}
[0m17:35:25.165355 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-eyz5i4z5'
[0m17:35:25.166759 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:35:25.590981 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:35:25.592185 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:35:25.651510 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:35:25.668830 [info ] [MainThread]: Updating lock file in file path: /usr/local/airflow/include/dbt/package-lock.yml
[0m17:35:25.680915 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-y02hl5u_'
[0m17:35:25.685116 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:35:29.641227 [info ] [MainThread]: Installed from version 1.1.1
[0m17:35:29.642210 [info ] [MainThread]: Updated version available: 1.3.0
[0m17:35:29.644054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3ec62c43-0519-4efd-9066-19943cf12970', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd9b7b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bda2f3470>]}
[0m17:35:29.645104 [info ] [MainThread]: 
[0m17:35:29.645911 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:35:29.654111 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.800204, "process_user_time": 1.993747, "process_kernel_time": 1.33581, "process_mem_max_rss": "95960", "process_in_blocks": "47096", "process_out_blocks": "200"}
[0m17:35:29.655335 [debug] [MainThread]: Command `dbt deps` succeeded at 17:35:29.655140 after 4.80 seconds
[0m17:35:29.656150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bda0ddbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd9183020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bda022780>]}
[0m17:35:29.656909 [debug] [MainThread]: Flushing usage events
[0m17:36:36.793383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00d83c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00caccf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00b9a57f0>]}


============================== 17:36:36.795751 | 65a1f5a9-1f01-4525-9def-d08d901650f9 ==============================
[0m17:36:36.795751 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:36:36.796651 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'empty': 'False', 'no_print': 'None', 'fail_fast': 'False', 'target_path': 'None', 'printer_width': '80', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True'}
[0m17:36:36.801396 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'retail'
[0m17:36:36.802814 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.07068716, "process_user_time": 1.410428, "process_kernel_time": 0.051102, "process_mem_max_rss": "92816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:36:36.803839 [debug] [MainThread]: Command `dbt run` failed at 17:36:36.803655 after 0.07 seconds
[0m17:36:36.804592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00b7ef2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00b7ef350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00b71ef00>]}
[0m17:36:36.805312 [debug] [MainThread]: Flushing usage events
[0m17:37:52.306635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3ed815b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3f7f9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3e228320>]}


============================== 17:37:52.308994 | a4e04b87-34bd-498d-b8ea-cc2702833b9f ==============================
[0m17:37:52.308994 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:37:52.309912 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'use_colors': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default'}
[0m17:37:52.426935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4e04b87-34bd-498d-b8ea-cc2702833b9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3cdcc980>]}
[0m17:37:52.740747 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ggd40igc'
[0m17:37:52.741592 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:37:52.853804 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:37:52.855861 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:37:52.904976 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:37:52.911294 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:38:02.095220 [info ] [MainThread]: Installed from version 1.1.1
[0m17:38:02.096063 [info ] [MainThread]: Updated version available: 1.3.0
[0m17:38:02.097051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a4e04b87-34bd-498d-b8ea-cc2702833b9f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3ccf66c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3ccf4bc0>]}
[0m17:38:02.097831 [info ] [MainThread]: 
[0m17:38:02.098597 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:38:02.100348 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 9.859526, "process_user_time": 1.74163, "process_kernel_time": 0.734907, "process_mem_max_rss": "96216", "process_out_blocks": "200", "process_in_blocks": "0"}
[0m17:38:02.101466 [debug] [MainThread]: Command `dbt deps` succeeded at 17:38:02.101157 after 9.86 seconds
[0m17:38:02.102101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3db89b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3cfa6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3cd0f650>]}
[0m17:38:02.102925 [debug] [MainThread]: Flushing usage events
[0m17:38:11.231439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52d344bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52d347680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52f1f3440>]}


============================== 17:38:11.233773 | ce33b93b-b09a-437f-bbfa-371d8d8fafa9 ==============================
[0m17:38:11.233773 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:38:11.234771 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'fail_fast': 'False', 'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'debug': 'False'}
[0m17:38:13.774730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce33b93b-b09a-437f-bbfa-371d8d8fafa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50aad1280>]}
[0m17:38:13.837549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce33b93b-b09a-437f-bbfa-371d8d8fafa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50ab89a90>]}
[0m17:38:13.838701 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m17:38:13.870554 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:38:13.874872 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:38:13.875660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ce33b93b-b09a-437f-bbfa-371d8d8fafa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50a82f110>]}
[0m17:38:15.915091 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.retail
[0m17:38:15.932918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce33b93b-b09a-437f-bbfa-371d8d8fafa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50a727500>]}
[0m17:38:16.056612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce33b93b-b09a-437f-bbfa-371d8d8fafa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50a5c46b0>]}
[0m17:38:16.057560 [info ] [MainThread]: Found 2 sources, 596 macros
[0m17:38:16.058321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce33b93b-b09a-437f-bbfa-371d8d8fafa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50a799ee0>]}
[0m17:38:16.060801 [info ] [MainThread]: 
[0m17:38:16.061741 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:38:16.064438 [debug] [MainThread]: Command end result
[0m17:38:16.127672 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.96241, "process_user_time": 4.989835, "process_kernel_time": 0.674854, "process_mem_max_rss": "230224", "process_in_blocks": "176088", "process_out_blocks": "0"}
[0m17:38:16.128786 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:16.128598 after 4.96 seconds
[0m17:38:16.129546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd52dd93290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50a5d21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50a9f0e30>]}
[0m17:38:16.130195 [debug] [MainThread]: Flushing usage events
[0m17:40:54.722891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e40bd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e20ab0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e20ab560>]}


============================== 17:40:54.726391 | 0eecf968-bed1-4f42-aae7-cc0650627f78 ==============================
[0m17:40:54.726391 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:40:54.727426 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'cache_selected_only': 'False'}
[0m17:40:56.770099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0eecf968-bed1-4f42-aae7-cc0650627f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e20f6ea0>]}
[0m17:40:56.821864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0eecf968-bed1-4f42-aae7-cc0650627f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e31f6b70>]}
[0m17:40:56.823375 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m17:40:56.866283 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:40:57.636976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m17:40:57.637804 [debug] [MainThread]: Partial parsing: added file: retail://models/transform/dim_datetime.sql
[0m17:40:57.638411 [debug] [MainThread]: Partial parsing: added file: retail://models/transform/dim_customer.sql
[0m17:40:57.638942 [debug] [MainThread]: Partial parsing: added file: retail://models/transform/fct_invoices.sql
[0m17:40:57.639425 [debug] [MainThread]: Partial parsing: added file: retail://models/transform/dim_product.sql
[0m17:40:58.115460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0eecf968-bed1-4f42-aae7-cc0650627f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8bfcba210>]}
[0m17:40:58.289680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0eecf968-bed1-4f42-aae7-cc0650627f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8bfebdd30>]}
[0m17:40:58.290573 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m17:40:58.291628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0eecf968-bed1-4f42-aae7-cc0650627f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8bfcdc8f0>]}
[0m17:40:58.294942 [info ] [MainThread]: 
[0m17:40:58.297551 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:40:58.304239 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m17:40:58.305268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:59.168227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m17:40:59.169401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:59.900514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0eecf968-bed1-4f42-aae7-cc0650627f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8bfcc2390>]}
[0m17:40:59.901401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:59.905812 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:59.906530 [info ] [MainThread]: 
[0m17:40:59.910400 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m17:40:59.911530 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m17:40:59.912355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m17:40:59.913281 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m17:40:59.925022 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m17:40:59.939739 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m17:40:59.994226 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m17:41:00.026521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:00.032518 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m17:41:01.136651 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:75e7069e-37d5-491c-8e38-e0155eb18ec7&page=queryresults
[0m17:41:04.924984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eecf968-bed1-4f42-aae7-cc0650627f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8c4ba6f30>]}
[0m17:41:04.926605 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 5.01s]
[0m17:41:04.928599 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m17:41:04.931391 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m17:41:04.932764 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m17:41:04.933712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m17:41:04.934523 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m17:41:04.941034 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m17:41:04.950601 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m17:41:04.955657 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m17:41:04.971289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:04.978482 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m17:41:06.010370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:112cea47-4983-4b66-b3b3-3fb774d7a745&page=queryresults
[0m17:41:06.551426 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m17:41:07.865942 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:84063b1b-88a4-4e0a-8a13-df514680a7f8&page=queryresults
[0m17:41:08.190444 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:84063b1b-88a4-4e0a-8a13-df514680a7f8&page=queryresults
[0m17:41:08.206097 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m17:41:08.207124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eecf968-bed1-4f42-aae7-cc0650627f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8bc802d50>]}
[0m17:41:08.208075 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 3.27s]
[0m17:41:08.209039 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m17:41:08.210331 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m17:41:08.212621 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m17:41:08.213747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m17:41:08.214876 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m17:41:08.220683 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m17:41:08.228663 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m17:41:08.234950 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m17:41:08.243383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:08.249554 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m17:41:09.193244 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:1a112c35-af0c-4479-b752-ca19d1cd577d&page=queryresults
[0m17:41:12.749841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0eecf968-bed1-4f42-aae7-cc0650627f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8bc888500>]}
[0m17:41:12.751567 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.54s]
[0m17:41:12.752829 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m17:41:12.754857 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m17:41:12.755845 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m17:41:12.756755 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m17:41:12.759086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:41:12.766875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:12.767948 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m17:41:12.769803 [info ] [MainThread]: 
[0m17:41:12.771072 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 14.47 seconds (14.47s).
[0m17:41:12.773869 [debug] [MainThread]: Command end result
[0m17:41:12.860883 [info ] [MainThread]: 
[0m17:41:12.864422 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:41:12.867417 [info ] [MainThread]: 
[0m17:41:12.869318 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m17:41:12.870662 [info ] [MainThread]: 
[0m17:41:12.873421 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m17:41:12.880837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 18.235924, "process_user_time": 4.846794, "process_kernel_time": 1.462995, "process_mem_max_rss": "241444", "process_in_blocks": "3408", "command_success": false, "process_out_blocks": "0"}
[0m17:41:12.885771 [debug] [MainThread]: Command `dbt run` failed at 17:41:12.884046 after 18.24 seconds
[0m17:41:12.889192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e5f86ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8bfcb2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e2578d70>]}
[0m17:41:12.891792 [debug] [MainThread]: Flushing usage events
[0m17:49:52.137325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20931de900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20933b6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209316a330>]}


============================== 17:49:52.140390 | 5b9853e6-c9b5-4272-9ae7-806bbd1c8c31 ==============================
[0m17:49:52.140390 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:49:52.141566 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_colors': 'True', 'empty': 'False', 'target_path': 'None', 'no_print': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'quiet': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'introspect': 'True'}
[0m17:49:53.886739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b9853e6-c9b5-4272-9ae7-806bbd1c8c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2075bcfef0>]}
[0m17:49:53.953932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b9853e6-c9b5-4272-9ae7-806bbd1c8c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209461d190>]}
[0m17:49:53.955311 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m17:49:53.996826 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:49:54.776966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:49:54.777938 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m17:49:55.131414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b9853e6-c9b5-4272-9ae7-806bbd1c8c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2074b388f0>]}
[0m17:49:55.254904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b9853e6-c9b5-4272-9ae7-806bbd1c8c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205f92b6b0>]}
[0m17:49:55.255867 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m17:49:55.256697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b9853e6-c9b5-4272-9ae7-806bbd1c8c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2074b387a0>]}
[0m17:49:55.260075 [info ] [MainThread]: 
[0m17:49:55.261495 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:49:55.267346 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m17:49:55.268267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:56.106810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m17:49:56.107752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:56.748266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b9853e6-c9b5-4272-9ae7-806bbd1c8c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2075a544d0>]}
[0m17:49:56.749797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:56.755478 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:49:56.756119 [info ] [MainThread]: 
[0m17:49:56.759677 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m17:49:56.760799 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m17:49:56.761544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m17:49:56.762324 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m17:49:56.786205 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m17:49:56.795702 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m17:49:56.814644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:57.500793 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m17:49:57.517637 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m17:49:58.284190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:5f056e9f-8d14-432a-b673-407f0dfb1b2f&page=queryresults
[0m17:50:01.460748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b9853e6-c9b5-4272-9ae7-806bbd1c8c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20759dee40>]}
[0m17:50:01.462824 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.70s]
[0m17:50:01.465232 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m17:50:01.466836 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m17:50:01.468050 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m17:50:01.469932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m17:50:01.471208 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m17:50:01.481793 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m17:50:01.495007 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m17:50:01.501312 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m17:50:01.513613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:01.519456 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "MM/DD/YYYY HH:MM"
        SAFE.PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        SAFE.PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "MM/DD/YYYY HH:MM"
        CASE 
          WHEN SAFE.PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate) IS NULL 
          THEN 'Error in parsing date (Expected format: MM/DD/YYYY HH:MM)'
          ELSE 'Valid date'
        END
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        CASE 
          WHEN SAFE.PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate) IS NULL 
          THEN 'Error in parsing date (Expected format: MM/DD/YY HH:MM)'
          ELSE 'Valid date'
        END
      ELSE
        'Unknown format'
    END AS error_status
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part AS datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday,
  error_status
FROM datetime_cte;
    );
  
[0m17:50:02.223338 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:fc2dc264-ab52-49c6-92e3-501c0a06201b&page=queryresults
[0m17:50:02.225380 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [57:18]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [57:18]')
[0m17:50:02.637387 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:6982f2e2-8c64-45f8-99f1-9b17563f82ad&page=queryresults
[0m17:50:02.638363 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:6982f2e2-8c64-45f8-99f1-9b17563f82ad&page=queryresults
[0m17:50:02.648849 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Syntax error: Expected ")" but got ";" at [57:18]
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m17:50:02.650027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b9853e6-c9b5-4272-9ae7-806bbd1c8c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205d53b9e0>]}
[0m17:50:02.651413 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 1.18s]
[0m17:50:02.652638 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m17:50:02.653993 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m17:50:02.656327 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m17:50:02.657531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m17:50:02.658679 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m17:50:02.664622 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m17:50:02.673326 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m17:50:02.677153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:03.377361 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m17:50:03.417051 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m17:50:04.047191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:a2a7b2f0-2bb8-4af8-b566-5b76caaae98d&page=queryresults
[0m17:50:07.340382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b9853e6-c9b5-4272-9ae7-806bbd1c8c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f205f974950>]}
[0m17:50:07.341754 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.68s]
[0m17:50:07.343251 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m17:50:07.345569 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m17:50:07.346641 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m17:50:07.347755 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m17:50:07.350353 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:07.356867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:07.358263 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m17:50:07.359756 [info ] [MainThread]: 
[0m17:50:07.361118 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.10 seconds (12.10s).
[0m17:50:07.365068 [debug] [MainThread]: Command end result
[0m17:50:07.433774 [info ] [MainThread]: 
[0m17:50:07.434808 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:50:07.436262 [info ] [MainThread]: 
[0m17:50:07.437599 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Syntax error: Expected ")" but got ";" at [57:18]
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m17:50:07.438736 [info ] [MainThread]: 
[0m17:50:07.439901 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m17:50:07.445548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.390155, "process_user_time": 4.607254, "process_kernel_time": 1.241178, "process_mem_max_rss": "241224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:50:07.447131 [debug] [MainThread]: Command `dbt run` failed at 17:50:07.446812 after 15.39 seconds
[0m17:50:07.448199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f209397e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2074ac62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2077fd6660>]}
[0m17:50:07.449120 [debug] [MainThread]: Flushing usage events
[0m17:51:41.071393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cb44b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cbfc6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cbfc70e0>]}


============================== 17:51:41.073870 | a9277e13-761d-4601-a5ea-5c5b7d4c5146 ==============================
[0m17:51:41.073870 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:51:41.074688 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'target_path': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'no_print': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'introspect': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False'}
[0m17:51:42.153549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9277e13-761d-4601-a5ea-5c5b7d4c5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a95795b0>]}
[0m17:51:42.208560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9277e13-761d-4601-a5ea-5c5b7d4c5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cc71d070>]}
[0m17:51:42.209884 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m17:51:42.250721 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:51:43.076103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:51:43.076971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:51:43.196090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9277e13-761d-4601-a5ea-5c5b7d4c5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3aa17c7a0>]}
[0m17:51:43.322132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9277e13-761d-4601-a5ea-5c5b7d4c5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a91250d0>]}
[0m17:51:43.323337 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m17:51:43.324455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9277e13-761d-4601-a5ea-5c5b7d4c5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a923eea0>]}
[0m17:51:43.328296 [info ] [MainThread]: 
[0m17:51:43.329740 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:51:43.334973 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m17:51:43.335860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:44.001975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m17:51:44.002889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:44.658560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9277e13-761d-4601-a5ea-5c5b7d4c5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cb6f2b40>]}
[0m17:51:44.661373 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:44.669846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:44.670746 [info ] [MainThread]: 
[0m17:51:44.677109 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m17:51:44.678353 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m17:51:44.679675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m17:51:44.680492 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m17:51:44.715866 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m17:51:44.723230 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m17:51:44.744466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:45.432088 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m17:51:45.443534 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m17:51:46.199281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:aceaa7b4-c80f-4ecb-88ff-aac6951ed371&page=queryresults
[0m17:51:49.498801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9277e13-761d-4601-a5ea-5c5b7d4c5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a9f433e0>]}
[0m17:51:49.500092 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.82s]
[0m17:51:49.501337 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m17:51:49.502641 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m17:51:49.503909 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m17:51:49.505302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m17:51:49.506406 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m17:51:49.512196 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m17:51:49.529841 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m17:51:49.537150 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m17:51:49.551509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:49.557687 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "MM/DD/YYYY HH:MM"
        SAFE.PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        SAFE.PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "MM/DD/YYYY HH:MM"
        CASE 
          WHEN SAFE.PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate) IS NULL 
          THEN 'Error in parsing date (Expected format: MM/DD/YYYY HH:MM)'
          ELSE 'Valid date'
        END
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        CASE 
          WHEN SAFE.PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate) IS NULL 
          THEN 'Error in parsing date (Expected format: MM/DD/YY HH:MM)'
          ELSE 'Valid date'
        END
      ELSE
        'Unknown format'
    END AS error_status
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part AS datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday,
  error_status
FROM datetime_cte;
    );
  
[0m17:51:50.267722 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:135a0286-a36c-4c1c-9d13-df00bf03d353&page=queryresults
[0m17:51:50.269163 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [57:18]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [57:18]')
[0m17:51:51.344185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:9e48ac01-feed-4dd6-beb3-e9b76b03b5eb&page=queryresults
[0m17:51:51.345402 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:9e48ac01-feed-4dd6-beb3-e9b76b03b5eb&page=queryresults
[0m17:51:51.353460 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Syntax error: Expected ")" but got ";" at [57:18]
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m17:51:51.354512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9277e13-761d-4601-a5ea-5c5b7d4c5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a94c5eb0>]}
[0m17:51:51.355526 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 1.85s]
[0m17:51:51.356690 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m17:51:51.358262 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m17:51:51.360618 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m17:51:51.361844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m17:51:51.362634 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m17:51:51.368700 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m17:51:51.375701 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m17:51:51.379114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:52.053784 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m17:51:52.063819 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m17:51:52.643157 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:b3e446a7-a2d4-4436-8c13-6f044c342218&page=queryresults
[0m17:51:55.647135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9277e13-761d-4601-a5ea-5c5b7d4c5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a8477d10>]}
[0m17:51:55.648366 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.29s]
[0m17:51:55.649909 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m17:51:55.651863 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m17:51:55.652648 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m17:51:55.653669 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m17:51:55.655834 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:55.660929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:55.662168 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m17:51:55.663592 [info ] [MainThread]: 
[0m17:51:55.665545 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.33 seconds (12.33s).
[0m17:51:55.669993 [debug] [MainThread]: Command end result
[0m17:51:55.761452 [info ] [MainThread]: 
[0m17:51:55.762688 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:51:55.763810 [info ] [MainThread]: 
[0m17:51:55.765119 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Syntax error: Expected ")" but got ";" at [57:18]
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m17:51:55.766413 [info ] [MainThread]: 
[0m17:51:55.767879 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m17:51:55.774069 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.765746, "process_user_time": 4.016214, "process_kernel_time": 0.436329, "process_mem_max_rss": "231584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:51:55.776120 [debug] [MainThread]: Command `dbt run` failed at 17:51:55.775818 after 14.77 seconds
[0m17:51:55.777470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cbf6e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cbef2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3cb919c70>]}
[0m17:51:55.778727 [debug] [MainThread]: Flushing usage events
[0m17:53:31.478384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2580aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c25076bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2517d700>]}


============================== 17:53:31.481969 | 9d7c2247-6c14-4670-a86c-f34536df5a02 ==============================
[0m17:53:31.481969 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:53:31.482908 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error': 'None', 'empty': 'False', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'printer_width': '80', 'quiet': 'False', 'debug': 'False', 'introspect': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'partial_parse': 'True', 'no_print': 'None', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'target_path': 'None'}
[0m17:53:33.246449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d7c2247-6c14-4670-a86c-f34536df5a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c24f034a0>]}
[0m17:53:33.310208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d7c2247-6c14-4670-a86c-f34536df5a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c038dd370>]}
[0m17:53:33.311466 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m17:53:33.352523 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:53:34.139429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:34.140534 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m17:53:34.522924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d7c2247-6c14-4670-a86c-f34536df5a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c02d156a0>]}
[0m17:53:34.680277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d7c2247-6c14-4670-a86c-f34536df5a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c02baa450>]}
[0m17:53:34.681232 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m17:53:34.682060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d7c2247-6c14-4670-a86c-f34536df5a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2646b050>]}
[0m17:53:34.685448 [info ] [MainThread]: 
[0m17:53:34.687607 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:53:34.693974 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m17:53:34.695061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:35.346061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m17:53:35.347549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:35.984749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d7c2247-6c14-4670-a86c-f34536df5a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c03919280>]}
[0m17:53:35.985855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:35.991175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:35.991926 [info ] [MainThread]: 
[0m17:53:35.995465 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m17:53:35.996644 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m17:53:35.997522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m17:53:35.998198 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m17:53:36.022479 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m17:53:36.185336 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m17:53:36.207040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:37.088728 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m17:53:37.099868 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m17:53:37.678534 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:959dd2c0-2e4e-416a-b346-47f95c0caa54&page=queryresults
[0m17:53:40.803609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7c2247-6c14-4670-a86c-f34536df5a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c038b3a40>]}
[0m17:53:40.805165 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.80s]
[0m17:53:40.806520 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m17:53:40.807701 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m17:53:40.808695 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m17:53:40.809555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m17:53:40.810238 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m17:53:40.815685 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m17:53:40.823352 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m17:53:40.828637 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m17:53:40.837539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:40.842965 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "MM/DD/YYYY HH:MM"
        SAFE.PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        SAFE.PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
    
    -- Adding error_status without nested CASE
    CASE
      WHEN LENGTH(InvoiceDate) = 16 AND SAFE.PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate) IS NULL THEN
        'Error in parsing date (Expected format: MM/DD/YYYY HH:MM)'
      WHEN LENGTH(InvoiceDate) <= 14 AND SAFE.PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate) IS NULL THEN
        'Error in parsing date (Expected format: MM/DD/YY HH:MM)'
      ELSE
        'Valid date'
    END AS error_status

  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)

SELECT
  datetime_id,
  date_part AS datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday,
  error_status
FROM datetime_cte;
    );
  
[0m17:53:41.479099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:e731c759-7641-4a6a-bce0-bc30ed5404cf&page=queryresults
[0m17:53:41.480166 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [51:18]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [51:18]')
[0m17:53:42.096575 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:22671a9f-420b-460d-a606-f5f6765e79d1&page=queryresults
[0m17:53:42.098037 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:22671a9f-420b-460d-a606-f5f6765e79d1&page=queryresults
[0m17:53:42.107009 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Syntax error: Expected ")" but got ";" at [51:18]
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m17:53:42.108120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7c2247-6c14-4670-a86c-f34536df5a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c01a940e0>]}
[0m17:53:42.109141 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 1.30s]
[0m17:53:42.110197 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m17:53:42.111093 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m17:53:42.112815 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m17:53:42.114282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m17:53:42.116308 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m17:53:42.123435 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m17:53:42.132777 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m17:53:42.135997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:42.803602 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m17:53:42.812139 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m17:53:43.407831 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:192effb9-1c58-48b8-a769-a4107f783558&page=queryresults
[0m17:53:46.925739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7c2247-6c14-4670-a86c-f34536df5a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c01a6a630>]}
[0m17:53:46.927040 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.81s]
[0m17:53:46.928342 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m17:53:46.930333 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m17:53:46.931171 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m17:53:46.931971 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m17:53:46.933705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:46.937534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:46.938309 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m17:53:46.939254 [info ] [MainThread]: 
[0m17:53:46.939945 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.25 seconds (12.25s).
[0m17:53:46.942138 [debug] [MainThread]: Command end result
[0m17:53:47.009548 [info ] [MainThread]: 
[0m17:53:47.010668 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:53:47.011728 [info ] [MainThread]: 
[0m17:53:47.013113 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Syntax error: Expected ")" but got ";" at [51:18]
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m17:53:47.014182 [info ] [MainThread]: 
[0m17:53:47.015191 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m17:53:47.019073 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.609459, "process_user_time": 4.72364, "process_kernel_time": 1.239827, "process_mem_max_rss": "241104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:53:47.020423 [debug] [MainThread]: Command `dbt run` failed at 17:53:47.020249 after 15.61 seconds
[0m17:53:47.021179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c25055970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c02d17980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2529d190>]}
[0m17:53:47.022456 [debug] [MainThread]: Flushing usage events
[0m17:54:39.924494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44f7967b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd451f5d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44f898bf0>]}


============================== 17:54:39.927368 | 050bb345-4781-4d76-82d3-efce8615e6e6 ==============================
[0m17:54:39.927368 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:54:39.928340 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'partial_parse': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True'}
[0m17:54:41.140063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '050bb345-4781-4d76-82d3-efce8615e6e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd42d491070>]}
[0m17:54:41.197093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '050bb345-4781-4d76-82d3-efce8615e6e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45069e6c0>]}
[0m17:54:41.198392 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m17:54:41.234220 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:54:41.995854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:41.996872 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m17:54:42.341067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '050bb345-4781-4d76-82d3-efce8615e6e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd42d13cb90>]}
[0m17:54:42.503054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '050bb345-4781-4d76-82d3-efce8615e6e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40ff27ef0>]}
[0m17:54:42.504454 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m17:54:42.505544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '050bb345-4781-4d76-82d3-efce8615e6e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd42d3ea780>]}
[0m17:54:42.508865 [info ] [MainThread]: 
[0m17:54:42.510506 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:54:42.516416 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m17:54:42.517338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:43.175241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m17:54:43.176038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:43.896860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '050bb345-4781-4d76-82d3-efce8615e6e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd450afc920>]}
[0m17:54:43.897966 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:43.902043 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:43.902771 [info ] [MainThread]: 
[0m17:54:43.906297 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m17:54:43.907220 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m17:54:43.908013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m17:54:43.908736 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m17:54:43.932249 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m17:54:43.944057 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m17:54:43.963352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:44.654473 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m17:54:44.668294 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m17:54:45.232638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:b272c1fd-6f0b-4752-8dd6-bbd7e61aad63&page=queryresults
[0m17:54:48.285235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '050bb345-4781-4d76-82d3-efce8615e6e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd42dfe2f30>]}
[0m17:54:48.286497 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.38s]
[0m17:54:48.288653 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m17:54:48.289926 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m17:54:48.291018 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m17:54:48.292028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m17:54:48.292894 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m17:54:48.297157 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m17:54:48.307640 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m17:54:48.312584 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m17:54:48.320390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:48.326146 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m17:54:49.194004 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:ce8a41e5-5b27-4e86-a723-d17ceac71302&page=queryresults
[0m17:54:49.835252 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("GET https://bigquery.googleapis.com/bigquery/v2/projects/airflow-tutorial-437816/queries/ce8a41e5-5b27-4e86-a723-d17ceac71302?maxResults=0&location=US&prettyPrint=false: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m17:54:50.652195 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:99eabecf-9909-4064-a0e0-a5a3d7dbee49&page=queryresults
[0m17:54:51.971730 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:99eabecf-9909-4064-a0e0-a5a3d7dbee49&page=queryresults
[0m17:54:51.982150 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m17:54:51.983209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '050bb345-4781-4d76-82d3-efce8615e6e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40db2f170>]}
[0m17:54:51.984194 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 3.69s]
[0m17:54:51.985164 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m17:54:51.986037 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m17:54:51.987925 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m17:54:51.990298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m17:54:51.991752 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m17:54:51.997716 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m17:54:52.004861 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m17:54:52.009322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:52.729608 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m17:54:52.740576 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m17:54:53.300252 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:84923aba-2bf1-4195-8f50-82181032306a&page=queryresults
[0m17:54:56.261751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '050bb345-4781-4d76-82d3-efce8615e6e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd40dab3ce0>]}
[0m17:54:56.263251 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.27s]
[0m17:54:56.264773 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m17:54:56.266891 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m17:54:56.267707 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m17:54:56.268673 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m17:54:56.271137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:56.276733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:56.277938 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m17:54:56.279034 [info ] [MainThread]: 
[0m17:54:56.280046 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 13.77 seconds (13.77s).
[0m17:54:56.283032 [debug] [MainThread]: Command end result
[0m17:54:56.354449 [info ] [MainThread]: 
[0m17:54:56.355647 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:56.357077 [info ] [MainThread]: 
[0m17:54:56.358360 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m17:54:56.359416 [info ] [MainThread]: 
[0m17:54:56.360364 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m17:54:56.362964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.511477, "process_user_time": 4.348144, "process_kernel_time": 0.506078, "process_mem_max_rss": "237360", "process_in_blocks": "384", "command_success": false, "process_out_blocks": "0"}
[0m17:54:56.364433 [debug] [MainThread]: Command `dbt run` failed at 17:54:56.364229 after 16.51 seconds
[0m17:54:56.365703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4533b2ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44f9bcf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44fedb5f0>]}
[0m17:54:56.367402 [debug] [MainThread]: Flushing usage events
[0m18:24:07.589567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e4b5c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e4ba1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e64ddac0>]}


============================== 18:24:07.594446 | c2005caa-29a1-4f5b-a08e-a8b7e1f22f99 ==============================
[0m18:24:07.594446 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:24:07.595443 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'introspect': 'True', 'no_print': 'None', 'version_check': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'partial_parse': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False'}
[0m18:24:10.075186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2005caa-29a1-4f5b-a08e-a8b7e1f22f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c1c59f70>]}
[0m18:24:10.143039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2005caa-29a1-4f5b-a08e-a8b7e1f22f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e51ecbf0>]}
[0m18:24:10.144330 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m18:24:10.193985 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:24:11.478205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:24:11.479087 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m18:24:11.800097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2005caa-29a1-4f5b-a08e-a8b7e1f22f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c1ab3e00>]}
[0m18:24:11.953678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2005caa-29a1-4f5b-a08e-a8b7e1f22f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c04cfa40>]}
[0m18:24:11.954931 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m18:24:11.955854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2005caa-29a1-4f5b-a08e-a8b7e1f22f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c1712210>]}
[0m18:24:11.958937 [info ] [MainThread]: 
[0m18:24:11.960316 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:24:11.967302 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m18:24:11.968129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:12.821987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m18:24:12.823063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:13.466055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2005caa-29a1-4f5b-a08e-a8b7e1f22f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e5048d10>]}
[0m18:24:13.466914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:13.470830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:13.471770 [info ] [MainThread]: 
[0m18:24:13.476216 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m18:24:13.477421 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m18:24:13.478351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m18:24:13.479163 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m18:24:13.507769 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m18:24:13.520390 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m18:24:13.540332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:14.251364 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m18:24:14.270325 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m18:24:14.864913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:57758d8a-c23c-4c1f-b288-2796845b372e&page=queryresults
[0m18:24:18.186631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2005caa-29a1-4f5b-a08e-a8b7e1f22f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c2553590>]}
[0m18:24:18.188534 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.71s]
[0m18:24:18.190714 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m18:24:18.191820 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m18:24:18.192802 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m18:24:18.193838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m18:24:18.194574 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m18:24:18.200226 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m18:24:18.209993 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m18:24:18.214004 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m18:24:18.222993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:18.229967 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H %M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m18:24:19.131205 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:253e2451-6d7b-459d-ad96-96308debf62e&page=queryresults
[0m18:24:19.740663 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/airflow-tutorial-437816/queries/253e2451-6d7b-459d-ad96-96308debf62e?maxResults=0&location=US&prettyPrint=false: Failed to parse input string "12/7/2010 9:26"')
[0m18:24:20.826239 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:46caedc7-0f1d-47c0-bd5a-20628cfe5d07&page=queryresults
[0m18:24:21.163351 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:46caedc7-0f1d-47c0-bd5a-20628cfe5d07&page=queryresults
[0m18:24:21.173075 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Failed to parse input string "12/7/2010 9:26"
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m18:24:21.174200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2005caa-29a1-4f5b-a08e-a8b7e1f22f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c0536360>]}
[0m18:24:21.175312 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 2.98s]
[0m18:24:21.176298 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m18:24:21.177119 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m18:24:21.178545 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m18:24:21.179347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m18:24:21.180139 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m18:24:21.186032 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m18:24:21.196404 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m18:24:21.199711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:21.824040 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m18:24:21.835094 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m18:24:22.444660 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:849ece61-efcf-46f0-9b4c-85e87e7ada41&page=queryresults
[0m18:24:25.656050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2005caa-29a1-4f5b-a08e-a8b7e1f22f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67c04c6000>]}
[0m18:24:25.657374 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.48s]
[0m18:24:25.658681 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m18:24:25.660461 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m18:24:25.661278 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m18:24:25.662044 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m18:24:25.663979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:24:25.668157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:25.668903 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m18:24:25.670015 [info ] [MainThread]: 
[0m18:24:25.670756 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 13.71 seconds (13.71s).
[0m18:24:25.672243 [debug] [MainThread]: Command end result
[0m18:24:25.734770 [info ] [MainThread]: 
[0m18:24:25.735730 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:24:25.736631 [info ] [MainThread]: 
[0m18:24:25.737697 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Failed to parse input string "12/7/2010 9:26"
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m18:24:25.738565 [info ] [MainThread]: 
[0m18:24:25.739715 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m18:24:25.745571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 18.283344, "process_user_time": 4.905118, "process_kernel_time": 1.942026, "process_mem_max_rss": "239080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:24:25.746672 [debug] [MainThread]: Command `dbt run` failed at 18:24:25.746495 after 18.28 seconds
[0m18:24:25.747487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e3d091c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e3f31160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67e3f31c10>]}
[0m18:24:25.748441 [debug] [MainThread]: Flushing usage events
[0m18:27:30.611664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931b5c40b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931d0fad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931d0f9ac0>]}


============================== 18:27:30.615500 | 001b126f-658b-46a9-921e-04e450d62110 ==============================
[0m18:27:30.615500 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:27:30.616879 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'fail_fast': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'debug': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'printer_width': '80', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'version_check': 'True', 'use_colors': 'True'}
[0m18:27:31.695726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '001b126f-658b-46a9-921e-04e450d62110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f7226d20>]}
[0m18:27:31.749278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '001b126f-658b-46a9-921e-04e450d62110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92fc28ff80>]}
[0m18:27:31.751107 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m18:27:31.786396 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:27:32.597645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:27:32.598640 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m18:27:32.906181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '001b126f-658b-46a9-921e-04e450d62110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f6fc4da0>]}
[0m18:27:33.022812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '001b126f-658b-46a9-921e-04e450d62110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f73c14f0>]}
[0m18:27:33.023761 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m18:27:33.024630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '001b126f-658b-46a9-921e-04e450d62110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f71d23f0>]}
[0m18:27:33.028047 [info ] [MainThread]: 
[0m18:27:33.029607 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:27:33.036770 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m18:27:33.038049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:33.715253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m18:27:33.716413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:34.371573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '001b126f-658b-46a9-921e-04e450d62110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f7cf0fe0>]}
[0m18:27:34.372663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:34.377443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:27:34.378212 [info ] [MainThread]: 
[0m18:27:34.382534 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m18:27:34.383689 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m18:27:34.384566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m18:27:34.385677 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m18:27:34.410935 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m18:27:34.418616 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m18:27:34.436240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:35.093564 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m18:27:35.112255 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m18:27:35.712737 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:2b38c48c-9c8e-4026-aec1-7adc82142038&page=queryresults
[0m18:27:38.731136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001b126f-658b-46a9-921e-04e450d62110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f7e93890>]}
[0m18:27:38.732924 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.35s]
[0m18:27:38.734446 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m18:27:38.735410 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m18:27:38.736391 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m18:27:38.737206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m18:27:38.738010 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m18:27:38.743128 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m18:27:38.753157 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m18:27:38.758479 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m18:27:38.766995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:38.772537 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m18:27:39.664707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:8fc764a1-af0b-4cc8-971a-e0e1d6afd5cc&page=queryresults
[0m18:27:40.000056 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m18:27:41.030815 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:cbb996bb-a6f3-49ea-92e6-19ad3f04884f&page=queryresults
[0m18:27:41.361481 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:cbb996bb-a6f3-49ea-92e6-19ad3f04884f&page=queryresults
[0m18:27:41.368669 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m18:27:41.369976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001b126f-658b-46a9-921e-04e450d62110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f5e9e510>]}
[0m18:27:41.371324 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 2.63s]
[0m18:27:41.372697 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m18:27:41.373739 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m18:27:41.375634 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m18:27:41.376820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m18:27:41.379213 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m18:27:41.384874 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m18:27:41.393575 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m18:27:41.396930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:42.040675 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m18:27:42.055068 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m18:27:42.621817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:c66058f4-6cdf-4d56-83e8-6f5639370c49&page=queryresults
[0m18:27:45.855362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001b126f-658b-46a9-921e-04e450d62110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f5de0e90>]}
[0m18:27:45.856958 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.48s]
[0m18:27:45.858241 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m18:27:45.860237 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m18:27:45.861140 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m18:27:45.861924 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m18:27:45.863955 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:45.868717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:45.870620 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m18:27:45.871970 [info ] [MainThread]: 
[0m18:27:45.873796 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.84 seconds (12.84s).
[0m18:27:45.875811 [debug] [MainThread]: Command end result
[0m18:27:45.938763 [info ] [MainThread]: 
[0m18:27:45.939660 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:27:45.940454 [info ] [MainThread]: 
[0m18:27:45.941446 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m18:27:45.942331 [info ] [MainThread]: 
[0m18:27:45.943301 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m18:27:45.945459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.408843, "process_user_time": 4.028399, "process_kernel_time": 0.59533, "process_mem_max_rss": "234268", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:27:45.946583 [debug] [MainThread]: Command `dbt run` failed at 18:27:45.946328 after 15.41 seconds
[0m18:27:45.947523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931a16da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92f43b4320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931d0f8b90>]}
[0m18:27:45.948722 [debug] [MainThread]: Flushing usage events
[0m18:30:16.584305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609a9814c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6099c37e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609a980f20>]}


============================== 18:30:16.587709 | d0620b60-c7fd-4ef4-87fb-2c093b12f753 ==============================
[0m18:30:16.587709 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:30:16.588737 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'target_path': 'None', 'fail_fast': 'False', 'empty': 'False', 'introspect': 'True', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error': 'None', 'static_parser': 'True', 'no_print': 'None'}
[0m18:30:18.191233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0620b60-c7fd-4ef4-87fb-2c093b12f753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6077873bf0>]}
[0m18:30:18.254195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0620b60-c7fd-4ef4-87fb-2c093b12f753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607770ec00>]}
[0m18:30:18.255453 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m18:30:18.294534 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:30:19.079229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:30:19.080131 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m18:30:19.412414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0620b60-c7fd-4ef4-87fb-2c093b12f753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60773f4f80>]}
[0m18:30:19.542081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0620b60-c7fd-4ef4-87fb-2c093b12f753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6076227ef0>]}
[0m18:30:19.543062 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m18:30:19.544001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0620b60-c7fd-4ef4-87fb-2c093b12f753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60776dc2c0>]}
[0m18:30:19.546581 [info ] [MainThread]: 
[0m18:30:19.547757 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:30:19.552689 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m18:30:19.553639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:20.401564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m18:30:20.402567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:21.121005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0620b60-c7fd-4ef4-87fb-2c093b12f753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607c1a8f20>]}
[0m18:30:21.122290 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:30:21.128746 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:30:21.129630 [info ] [MainThread]: 
[0m18:30:21.134517 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m18:30:21.136196 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m18:30:21.137387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m18:30:21.138192 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m18:30:21.165475 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m18:30:21.176664 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m18:30:21.195324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:21.921390 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m18:30:21.932731 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m18:30:22.525962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:06b2fbe8-de42-4edf-ae0b-1cd1d0285918&page=queryresults
[0m18:30:25.836796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0620b60-c7fd-4ef4-87fb-2c093b12f753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607c347980>]}
[0m18:30:25.838064 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.70s]
[0m18:30:25.839422 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m18:30:25.840433 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m18:30:25.841306 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m18:30:25.842071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m18:30:25.842802 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m18:30:25.847839 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m18:30:25.855901 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m18:30:25.859759 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m18:30:25.866786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:25.871508 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H,%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H,%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m18:30:26.818554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:623e469f-40cb-4953-b0d2-fec5e1af6e71&page=queryresults
[0m18:30:27.148432 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ',' and string character ' ' at string index: 9 with format: '%m/%d/%y %H,%M'; reason: invalidQuery, location: query, message: Mismatch between format character ',' and string character ' ' at string index: 9 with format: '%m/%d/%y %H,%M'")
[0m18:30:28.653286 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:5ae1b729-adc5-4f8f-8e2c-9b9facf8947b&page=queryresults
[0m18:30:28.989152 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:5ae1b729-adc5-4f8f-8e2c-9b9facf8947b&page=queryresults
[0m18:30:28.999588 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ',' and string character ' ' at string index: 9 with format: '%m/%d/%y %H,%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m18:30:29.000887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0620b60-c7fd-4ef4-87fb-2c093b12f753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f606fd2ad80>]}
[0m18:30:29.001999 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 3.16s]
[0m18:30:29.003257 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m18:30:29.004833 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m18:30:29.006526 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m18:30:29.007711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m18:30:29.009262 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m18:30:29.015834 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m18:30:29.026867 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m18:30:29.030212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:29.752154 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m18:30:29.763536 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m18:30:30.357654 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:0da90de7-dc6d-486b-a1d9-85a9a2d7da5d&page=queryresults
[0m18:30:33.548979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0620b60-c7fd-4ef4-87fb-2c093b12f753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f606fc07fe0>]}
[0m18:30:33.549964 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.54s]
[0m18:30:33.551091 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m18:30:33.552994 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m18:30:33.553938 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m18:30:33.554778 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m18:30:33.556736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:30:33.560645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:33.561199 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m18:30:33.561971 [info ] [MainThread]: 
[0m18:30:33.562744 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 14.01 seconds (14.01s).
[0m18:30:33.564698 [debug] [MainThread]: Command end result
[0m18:30:33.628738 [info ] [MainThread]: 
[0m18:30:33.629897 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:30:33.630860 [info ] [MainThread]: 
[0m18:30:33.632165 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ',' and string character ' ' at string index: 9 with format: '%m/%d/%y %H,%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m18:30:33.633310 [info ] [MainThread]: 
[0m18:30:33.634312 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m18:30:33.638023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.13357, "process_user_time": 4.248064, "process_kernel_time": 1.138758, "process_mem_max_rss": "237272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:30:33.639382 [debug] [MainThread]: Command `dbt run` failed at 18:30:33.639133 after 17.14 seconds
[0m18:30:33.640314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6099bd5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f606fd00d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60775492e0>]}
[0m18:30:33.641048 [debug] [MainThread]: Flushing usage events
[0m18:31:27.408655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff4db5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff467a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff4db5220>]}


============================== 18:31:27.411097 | 9cb04e6d-5d4e-4c8f-9f5a-d52520e50bc0 ==============================
[0m18:31:27.411097 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:31:27.411904 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'empty': 'False', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'use_colors': 'True'}
[0m18:31:28.387223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cb04e6d-5d4e-4c8f-9f5a-d52520e50bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd1e31790>]}
[0m18:31:28.443674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cb04e6d-5d4e-4c8f-9f5a-d52520e50bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff525c6b0>]}
[0m18:31:28.445143 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m18:31:28.481498 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:31:29.238841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:31:29.239780 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m18:31:29.568900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cb04e6d-5d4e-4c8f-9f5a-d52520e50bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd1b2e270>]}
[0m18:31:29.683512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cb04e6d-5d4e-4c8f-9f5a-d52520e50bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd08d7b90>]}
[0m18:31:29.684713 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m18:31:29.685612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cb04e6d-5d4e-4c8f-9f5a-d52520e50bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd182be60>]}
[0m18:31:29.688800 [info ] [MainThread]: 
[0m18:31:29.690334 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:31:29.695479 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m18:31:29.696407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:30.387380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m18:31:30.389058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:31.082629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cb04e6d-5d4e-4c8f-9f5a-d52520e50bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd25c0b90>]}
[0m18:31:31.083594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:31.087788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:31.088439 [info ] [MainThread]: 
[0m18:31:31.091555 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m18:31:31.092669 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m18:31:31.093509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m18:31:31.094274 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m18:31:31.117730 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m18:31:31.129225 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m18:31:31.152228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:31.893283 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m18:31:31.904155 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m18:31:32.456471 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:6beb9bd7-e738-4142-90e8-e39db943fa00&page=queryresults
[0m18:31:35.736816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb04e6d-5d4e-4c8f-9f5a-d52520e50bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd274f260>]}
[0m18:31:35.737964 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.64s]
[0m18:31:35.739155 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m18:31:35.740163 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m18:31:35.741026 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m18:31:35.741874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m18:31:35.742617 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m18:31:35.747499 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m18:31:35.754049 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m18:31:35.758940 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m18:31:35.766118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:35.770757 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(TRIM(InvoiceDate)) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%d/%m/%Y %H:%M', TRIM(InvoiceDate))
      WHEN LENGTH(TRIM(InvoiceDate)) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', TRIM(InvoiceDate))
      ELSE
        NULL
    END AS date_part
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part AS datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m18:31:36.698482 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:c5b5039a-8368-440f-8c2d-f96dcb9ab226&page=queryresults
[0m18:31:37.032958 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m18:31:38.082265 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:2ef14a4a-9cc5-4805-87e0-7fc45f251b59&page=queryresults
[0m18:31:38.398547 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:2ef14a4a-9cc5-4805-87e0-7fc45f251b59&page=queryresults
[0m18:31:38.405763 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m18:31:38.406853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb04e6d-5d4e-4c8f-9f5a-d52520e50bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff463f560>]}
[0m18:31:38.408072 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 2.67s]
[0m18:31:38.409451 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m18:31:38.410937 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m18:31:38.413462 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m18:31:38.414729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m18:31:38.415701 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m18:31:38.421744 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m18:31:38.429474 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m18:31:38.432925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:39.116014 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m18:31:39.124468 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m18:31:39.723005 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:c250dbef-0fb9-47ff-8078-04926e13d6b8&page=queryresults
[0m18:31:42.962284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb04e6d-5d4e-4c8f-9f5a-d52520e50bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fca12cf80>]}
[0m18:31:42.963698 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.55s]
[0m18:31:42.964738 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m18:31:42.966394 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m18:31:42.967083 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m18:31:42.967851 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m18:31:42.969616 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:42.973971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:42.974700 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m18:31:42.975505 [info ] [MainThread]: 
[0m18:31:42.976819 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 13.29 seconds (13.29s).
[0m18:31:42.979479 [debug] [MainThread]: Command end result
[0m18:31:43.095789 [info ] [MainThread]: 
[0m18:31:43.096644 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:31:43.097603 [info ] [MainThread]: 
[0m18:31:43.098704 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m18:31:43.099457 [info ] [MainThread]: 
[0m18:31:43.100351 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m18:31:43.102192 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.761505, "process_user_time": 4.061511, "process_kernel_time": 0.263339, "process_mem_max_rss": "232740", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:31:43.103370 [debug] [MainThread]: Command `dbt run` failed at 18:31:43.103200 after 15.76 seconds
[0m18:31:43.104288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ff4f3da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd1823ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd9d295e0>]}
[0m18:31:43.105255 [debug] [MainThread]: Flushing usage events
[0m13:15:28.534591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734c8daba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734c08e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734c876c60>]}


============================== 13:15:28.538559 | a7b454be-8a9d-4613-8c2b-f3c0fa428380 ==============================
[0m13:15:28.538559 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:15:28.539813 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt', 'invocation_command': 'dbt deps', 'empty': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None', 'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False'}
[0m13:15:28.733125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7b454be-8a9d-4613-8c2b-f3c0fa428380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734c3440e0>]}
[0m13:15:29.317346 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d41qtegn'
[0m13:15:29.318370 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:15:29.510132 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:15:29.512595 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:15:29.575930 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:15:29.581754 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:15:33.393499 [info ] [MainThread]: Installed from version 1.1.1
[0m13:15:33.394529 [info ] [MainThread]: Updated version available: 1.3.0
[0m13:15:33.395617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a7b454be-8a9d-4613-8c2b-f3c0fa428380', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734bcaa870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734bca8aa0>]}
[0m13:15:33.396769 [info ] [MainThread]: 
[0m13:15:33.397684 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:15:33.403665 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.9959126, "process_user_time": 2.097917, "process_kernel_time": 1.307397, "process_mem_max_rss": "96128", "process_in_blocks": "38048", "process_out_blocks": "200"}
[0m13:15:33.404690 [debug] [MainThread]: Command `dbt deps` succeeded at 13:15:33.404500 after 5.00 seconds
[0m13:15:33.405371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734cc46030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734bd5fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f734bcc7b60>]}
[0m13:15:33.406111 [debug] [MainThread]: Flushing usage events
[0m13:17:23.470151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39945e3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3993b66630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3993d029f0>]}


============================== 13:17:23.473792 | f5b59a49-a1b8-484c-8bbd-8f4e2f43bb70 ==============================
[0m13:17:23.473792 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:17:23.474636 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'log_format': 'default', 'printer_width': '80', 'empty': 'False', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'debug': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'static_parser': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'write_json': 'True', 'partial_parse': 'True', 'introspect': 'True', 'target_path': 'None'}
[0m13:17:25.688769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5b59a49-a1b8-484c-8bbd-8f4e2f43bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3971c052b0>]}
[0m13:17:25.739511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5b59a49-a1b8-484c-8bbd-8f4e2f43bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3972df3380>]}
[0m13:17:25.740919 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m13:17:25.777707 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:17:26.552394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:26.553179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:26.676033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5b59a49-a1b8-484c-8bbd-8f4e2f43bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39950a7800>]}
[0m13:17:26.837457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5b59a49-a1b8-484c-8bbd-8f4e2f43bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39716e6e70>]}
[0m13:17:26.838486 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m13:17:26.839431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5b59a49-a1b8-484c-8bbd-8f4e2f43bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39715cb7d0>]}
[0m13:17:26.842703 [info ] [MainThread]: 
[0m13:17:26.844215 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:17:26.849907 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m13:17:26.850698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:27.672513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m13:17:27.673977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:17:28.345458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5b59a49-a1b8-484c-8bbd-8f4e2f43bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39718a6450>]}
[0m13:17:28.346506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:17:28.354282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:17:28.355212 [info ] [MainThread]: 
[0m13:17:28.360052 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:17:28.361044 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m13:17:28.361963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m13:17:28.363064 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:17:28.391119 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:17:28.400294 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:17:28.445147 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:17:28.459655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:28.463301 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m13:17:29.535801 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:0a26087e-9268-4561-9a5b-10f6f8b645b6&page=queryresults
[0m13:17:32.314603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b59a49-a1b8-484c-8bbd-8f4e2f43bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3994443260>]}
[0m13:17:32.316127 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (11.0 rows, 7.2 KiB processed)[0m in 3.95s]
[0m13:17:32.317987 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:17:32.319187 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:17:32.320045 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m13:17:32.320942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:17:32.322454 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:17:32.328462 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:17:32.336648 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:17:32.342971 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:17:32.351851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:32.358822 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(TRIM(InvoiceDate)) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%d/%m/%Y %H:%M', TRIM(InvoiceDate))
      WHEN LENGTH(TRIM(InvoiceDate)) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', TRIM(InvoiceDate))
      ELSE
        NULL
    END AS date_part
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part AS datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m13:17:33.220817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:94508303-4510-4115-8524-f03d9c519e7d&page=queryresults
[0m13:17:33.547441 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'; reason: invalidQuery, location: query, message: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m13:17:34.410992 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:5f3bbe14-1d0a-44f8-a1d6-5739af056e68&page=queryresults
[0m13:17:34.970689 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:5f3bbe14-1d0a-44f8-a1d6-5739af056e68&page=queryresults
[0m13:17:35.005897 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m13:17:35.007521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b59a49-a1b8-484c-8bbd-8f4e2f43bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3971643da0>]}
[0m13:17:35.009174 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 2.69s]
[0m13:17:35.011628 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:17:35.014474 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:17:35.017510 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m13:17:35.025649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:17:35.028033 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:17:35.044610 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:17:35.053147 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:17:35.059947 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:17:35.069448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:35.075998 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m13:17:35.997709 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:e3431202-4e03-424e-8750-a3d9782119f9&page=queryresults
[0m13:17:38.323577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b59a49-a1b8-484c-8bbd-8f4e2f43bb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39701aa690>]}
[0m13:17:38.324990 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (115.0 rows, 6.3 KiB processed)[0m in 3.30s]
[0m13:17:38.326151 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:17:38.327781 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:17:38.328554 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m13:17:38.329313 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:17:38.331177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:17:38.335180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:38.336190 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m13:17:38.337208 [info ] [MainThread]: 
[0m13:17:38.338139 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.49 seconds (11.49s).
[0m13:17:38.341269 [debug] [MainThread]: Command end result
[0m13:17:38.425340 [info ] [MainThread]: 
[0m13:17:38.426314 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:17:38.426992 [info ] [MainThread]: 
[0m13:17:38.428309 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m13:17:38.429539 [info ] [MainThread]: 
[0m13:17:38.430746 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m13:17:38.432774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.034052, "process_user_time": 4.040686, "process_kernel_time": 0.838442, "process_mem_max_rss": "233424", "process_in_blocks": "175528", "command_success": false, "process_out_blocks": "0"}
[0m13:17:38.434041 [debug] [MainThread]: Command `dbt run` failed at 13:17:38.433811 after 15.04 seconds
[0m13:17:38.435370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39947c86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3971b99d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f399677f740>]}
[0m13:17:38.436714 [debug] [MainThread]: Flushing usage events
[0m13:18:58.057730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d138a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d138a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d1389d60>]}


============================== 13:18:58.060420 | afb437f3-017c-4b59-8700-f8780df2ced6 ==============================
[0m13:18:58.060420 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:18:58.061507 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'partial_parse': 'True', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'static_parser': 'True', 'log_format': 'default', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'debug': 'False', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m13:18:59.182073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afb437f3-017c-4b59-8700-f8780df2ced6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d2860d10>]}
[0m13:18:59.237542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afb437f3-017c-4b59-8700-f8780df2ced6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d135a780>]}
[0m13:18:59.239092 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m13:18:59.274772 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:19:00.152751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:00.153783 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m13:19:00.509471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afb437f3-017c-4b59-8700-f8780df2ced6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02aec64950>]}
[0m13:19:00.642791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afb437f3-017c-4b59-8700-f8780df2ced6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02aec64fe0>]}
[0m13:19:00.643727 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m13:19:00.644559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb437f3-017c-4b59-8700-f8780df2ced6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02aeed55e0>]}
[0m13:19:00.647580 [info ] [MainThread]: 
[0m13:19:00.649031 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:19:00.654365 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m13:19:00.655422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:01.330387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m13:19:01.331165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:01.974491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb437f3-017c-4b59-8700-f8780df2ced6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02aeb9ad80>]}
[0m13:19:01.975460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:01.980860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:19:01.981594 [info ] [MainThread]: 
[0m13:19:01.985523 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:19:01.986862 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m13:19:01.987910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m13:19:01.988758 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:19:02.015551 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:19:02.025747 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:19:02.045329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:02.720281 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:19:02.730491 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m13:19:03.458083 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:fdea4c93-94dc-4d5c-af9e-6e1b286be89e&page=queryresults
[0m13:19:05.841593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb437f3-017c-4b59-8700-f8780df2ced6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02afaff200>]}
[0m13:19:05.843156 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (11.0 rows, 7.2 KiB processed)[0m in 3.85s]
[0m13:19:05.845235 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:19:05.846486 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:19:05.847362 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m13:19:05.848246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:19:05.849190 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:19:05.854808 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:19:05.864050 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:19:05.868116 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:19:05.877259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:05.882895 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m13:19:06.787437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:769bf2e1-e75f-4aca-aadb-367fbb1f2999&page=queryresults
[0m13:19:07.748185 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("GET https://bigquery.googleapis.com/bigquery/v2/projects/airflow-tutorial-437816/queries/769bf2e1-e75f-4aca-aadb-367fbb1f2999?maxResults=0&location=US&prettyPrint=false: Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'")
[0m13:19:08.560323 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:9bf0f9a4-8ff8-4d35-8a18-1f2942096838&page=queryresults
[0m13:19:08.927218 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:9bf0f9a4-8ff8-4d35-8a18-1f2942096838&page=queryresults
[0m13:19:08.933317 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m13:19:08.934379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb437f3-017c-4b59-8700-f8780df2ced6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02aebb3f20>]}
[0m13:19:08.935678 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 3.09s]
[0m13:19:08.936798 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:19:08.937807 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:19:08.939829 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m13:19:08.941164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:19:08.943339 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:19:08.949555 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:19:08.960153 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:19:08.963467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:09.603621 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:19:09.613386 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m13:19:10.233117 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:86bdd05b-569b-4f0c-b106-653199ef1942&page=queryresults
[0m13:19:13.090527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb437f3-017c-4b59-8700-f8780df2ced6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02adaa8980>]}
[0m13:19:13.091669 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (115.0 rows, 6.3 KiB processed)[0m in 4.15s]
[0m13:19:13.092727 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:19:13.094436 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:19:13.095321 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m13:19:13.095998 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:19:13.097805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:19:13.102118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:13.102937 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m13:19:13.103706 [info ] [MainThread]: 
[0m13:19:13.104684 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.45 seconds (12.45s).
[0m13:19:13.106660 [debug] [MainThread]: Command end result
[0m13:19:13.173029 [info ] [MainThread]: 
[0m13:19:13.173966 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:19:13.174701 [info ] [MainThread]: 
[0m13:19:13.175745 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Mismatch between format character ':' and string character ' ' at string index: 9 with format: '%m/%d/%y %H:%M'
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m13:19:13.176619 [info ] [MainThread]: 
[0m13:19:13.177524 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m13:19:13.179105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.196306, "process_user_time": 4.166291, "process_kernel_time": 0.394909, "process_mem_max_rss": "240516", "process_in_blocks": "480", "command_success": false, "process_out_blocks": "0"}
[0m13:19:13.180083 [debug] [MainThread]: Command `dbt run` failed at 13:19:13.179927 after 15.20 seconds
[0m13:19:13.180767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d1acedb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d1581010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d1581850>]}
[0m13:19:13.181463 [debug] [MainThread]: Flushing usage events
[0m13:26:05.061301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee1ada720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee4279370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee1abfef0>]}


============================== 13:26:05.064079 | f7286ace-b7b0-42ef-9f02-b992fc80881b ==============================
[0m13:26:05.064079 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:26:05.065015 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'printer_width': '80', 'introspect': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'empty': 'False', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_format': 'default'}
[0m13:26:06.563538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7286ace-b7b0-42ef-9f02-b992fc80881b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ebf9ffdd0>]}
[0m13:26:06.615331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7286ace-b7b0-42ef-9f02-b992fc80881b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ebf7bba70>]}
[0m13:26:06.616633 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m13:26:06.654275 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:26:07.446255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:26:07.447376 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m13:26:07.797075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7286ace-b7b0-42ef-9f02-b992fc80881b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ebf349af0>]}
[0m13:26:07.922257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7286ace-b7b0-42ef-9f02-b992fc80881b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ebe43f950>]}
[0m13:26:07.923242 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m13:26:07.924003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7286ace-b7b0-42ef-9f02-b992fc80881b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ebf6ecc20>]}
[0m13:26:07.926598 [info ] [MainThread]: 
[0m13:26:07.928023 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:26:07.933501 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m13:26:07.934599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:08.814870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m13:26:08.815868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:09.554165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7286ace-b7b0-42ef-9f02-b992fc80881b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ebf34a330>]}
[0m13:26:09.555235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:09.560034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:26:09.560825 [info ] [MainThread]: 
[0m13:26:09.564330 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:26:09.565486 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m13:26:09.566281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m13:26:09.566903 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:26:09.591716 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:26:09.603856 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:26:09.621869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:10.352197 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:26:10.364622 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m13:26:11.016056 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:a1f30340-1317-4c97-9caa-5e2885c2c288&page=queryresults
[0m13:26:13.770468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7286ace-b7b0-42ef-9f02-b992fc80881b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec42eac00>]}
[0m13:26:13.771657 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (11.0 rows, 7.2 KiB processed)[0m in 4.20s]
[0m13:26:13.772823 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:26:13.773898 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:26:13.774762 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m13:26:13.775630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:26:13.776580 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:26:13.782180 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:26:13.792208 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:26:13.797276 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:26:13.808615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:13.814048 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 14 THEN
        -- Date format: "MM/DD/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 12 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte;
    );
  
[0m13:26:14.510332 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:22971947-b77a-4dd2-a623-8aa8f5dad9e7&page=queryresults
[0m13:26:14.512492 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [38:18]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [38:18]')
[0m13:26:15.711235 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:48434a95-d051-4499-a1f3-43387ea32f6a&page=queryresults
[0m13:26:15.713614 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:48434a95-d051-4499-a1f3-43387ea32f6a&page=queryresults
[0m13:26:15.727438 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Syntax error: Expected ")" but got ";" at [38:18]
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m13:26:15.733890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7286ace-b7b0-42ef-9f02-b992fc80881b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ebe4cbfe0>]}
[0m13:26:15.735457 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model retail.dim_datetime ...................... [[31mERROR[0m in 1.96s]
[0m13:26:15.737066 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:26:15.738907 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:26:15.741559 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m13:26:15.744141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:26:15.745409 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:26:15.754252 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:26:15.767379 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:26:15.773887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:16.496457 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:26:16.506594 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m13:26:17.041455 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:5985d51d-8fa6-4c19-986b-11a51ff93342&page=queryresults
[0m13:26:19.665455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7286ace-b7b0-42ef-9f02-b992fc80881b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ebe404e30>]}
[0m13:26:19.667424 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (115.0 rows, 6.3 KiB processed)[0m in 3.92s]
[0m13:26:19.669148 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:26:19.671107 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:26:19.672177 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m13:26:19.673299 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:26:19.675709 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:26:19.679660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:19.680557 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m13:26:19.681425 [info ] [MainThread]: 
[0m13:26:19.682339 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.75 seconds (11.75s).
[0m13:26:19.685257 [debug] [MainThread]: Command end result
[0m13:26:19.751119 [info ] [MainThread]: 
[0m13:26:19.752199 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:26:19.753205 [info ] [MainThread]: 
[0m13:26:19.754306 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  Syntax error: Expected ")" but got ";" at [38:18]
  compiled code at target/run/retail/models/transform/dim_datetime.sql
[0m13:26:19.755192 [info ] [MainThread]: 
[0m13:26:19.756218 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m13:26:19.759123 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.778936, "process_user_time": 4.379071, "process_kernel_time": 1.032138, "process_mem_max_rss": "239040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:26:19.760558 [debug] [MainThread]: Command `dbt run` failed at 13:26:19.760279 after 14.78 seconds
[0m13:26:19.761507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee23bb080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ebf528bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ebf3f2270>]}
[0m13:26:19.762079 [debug] [MainThread]: Flushing usage events
[0m13:27:55.430740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f048fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24ec1b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24ec1ab10>]}


============================== 13:27:55.433615 | d8cd6358-8cbd-40f7-8811-a98fc87ebe7e ==============================
[0m13:27:55.433615 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:27:55.434523 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'static_parser': 'True', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'empty': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'fail_fast': 'False'}
[0m13:27:56.588394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8cd6358-8cbd-40f7-8811-a98fc87ebe7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f22e8d0>]}
[0m13:27:56.639587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8cd6358-8cbd-40f7-8811-a98fc87ebe7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24f6cd0d0>]}
[0m13:27:56.640997 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m13:27:56.678220 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:27:57.528680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:27:57.529650 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m13:27:57.856527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8cd6358-8cbd-40f7-8811-a98fc87ebe7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22bbdd130>]}
[0m13:27:57.988942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8cd6358-8cbd-40f7-8811-a98fc87ebe7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22bd3f860>]}
[0m13:27:57.989821 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m13:27:57.990662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8cd6358-8cbd-40f7-8811-a98fc87ebe7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22be8e1e0>]}
[0m13:27:57.993143 [info ] [MainThread]: 
[0m13:27:57.994341 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:27:58.000103 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m13:27:58.001023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:58.742841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m13:27:58.743970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:59.456185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8cd6358-8cbd-40f7-8811-a98fc87ebe7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22bceb770>]}
[0m13:27:59.457045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:59.460946 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:27:59.461667 [info ] [MainThread]: 
[0m13:27:59.465591 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:27:59.466803 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m13:27:59.467947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m13:27:59.468828 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:27:59.498190 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:27:59.508454 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:27:59.527997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:00.288825 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:28:00.299812 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m13:28:00.921049 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:7ef204f2-a86d-4e6f-a8a1-e5955f0327b7&page=queryresults
[0m13:28:03.711157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8cd6358-8cbd-40f7-8811-a98fc87ebe7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe230b57170>]}
[0m13:28:03.712527 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (11.0 rows, 7.2 KiB processed)[0m in 4.24s]
[0m13:28:03.713797 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:28:03.714992 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:28:03.716011 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m13:28:03.716869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:28:03.717639 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:28:03.722759 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:28:03.730958 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:28:03.735357 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:28:03.743837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:03.748483 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 14 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 12 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m13:28:04.750306 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:27af0d6c-19b9-43d7-9d0a-9f390f7569f5&page=queryresults
[0m13:28:07.166534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8cd6358-8cbd-40f7-8811-a98fc87ebe7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22aaa1760>]}
[0m13:28:07.167646 [info ] [Thread-1 (]: 2 of 4 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (14.0 rows, 2.3 KiB processed)[0m in 3.45s]
[0m13:28:07.169056 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:28:07.170141 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:28:07.171120 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m13:28:07.171925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:28:07.172759 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:28:07.178294 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:28:07.186918 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:28:07.191638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:07.920960 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:28:07.932714 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m13:28:08.536933 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:ec091f7a-5638-4694-943d-fd6972da728a&page=queryresults
[0m13:28:10.974035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8cd6358-8cbd-40f7-8811-a98fc87ebe7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22bb95280>]}
[0m13:28:10.975609 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (115.0 rows, 6.3 KiB processed)[0m in 3.80s]
[0m13:28:10.977139 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:28:10.979229 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:28:10.980273 [info ] [Thread-1 (]: 4 of 4 START sql table model retail.fct_invoices ............................... [RUN]
[0m13:28:10.981219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_product, now model.retail.fct_invoices)
[0m13:28:10.982001 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m13:28:10.988955 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m13:28:10.996817 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m13:28:11.001976 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m13:28:11.008566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:11.013130 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`fct_invoices`
      
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql

-- Create the fact table by joining the relevant keys from dimension table
WITH fct_invoices_cte AS (
    SELECT
        InvoiceNo AS invoice_id,
        InvoiceDate AS datetime_id,
        to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
        to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
        Quantity AS quantity,
        Quantity * UnitPrice AS total
    FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
    WHERE Quantity > 0
)
SELECT
    invoice_id,
    dt.datetime_id,
    dp.product_id,
    dc.customer_id,
    quantity,
    total
FROM fct_invoices_cte fi
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_product` dp ON fi.product_id = dp.product_id
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_customer` dc ON fi.customer_id = dc.customer_id
    );
  
[0m13:28:12.277783 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:fae4da45-bad3-4635-af0e-e8e372015f9d&page=queryresults
[0m13:28:14.452653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8cd6358-8cbd-40f7-8811-a98fc87ebe7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe22864be60>]}
[0m13:28:14.453955 [info ] [Thread-1 (]: 4 of 4 OK created sql table model retail.fct_invoices .......................... [[32mCREATE TABLE (144.0 rows, 18.5 KiB processed)[0m in 3.47s]
[0m13:28:14.455198 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:28:14.457541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:14.461516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:14.462153 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m13:28:14.463097 [info ] [MainThread]: 
[0m13:28:14.464112 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 16.47 seconds (16.47s).
[0m13:28:14.466697 [debug] [MainThread]: Command end result
[0m13:28:14.542544 [info ] [MainThread]: 
[0m13:28:14.543479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:14.544479 [info ] [MainThread]: 
[0m13:28:14.545414 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:28:14.547128 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.194132, "process_user_time": 4.297814, "process_kernel_time": 0.402605, "process_mem_max_rss": "234516", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:28:14.548300 [debug] [MainThread]: Command `dbt run` succeeded at 13:28:14.548074 after 19.20 seconds
[0m13:28:14.549224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24e444d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe228731490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24e564b60>]}
[0m13:28:14.550109 [debug] [MainThread]: Flushing usage events
[0m13:37:38.966458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf852adb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf85c34770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf87868e30>]}


============================== 13:37:38.969418 | a0ba3400-8bf4-4c2e-bd00-6328215131bd ==============================
[0m13:37:38.969418 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:37:38.970388 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt deps', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'no_print': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True'}
[0m13:37:39.103513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0ba3400-8bf4-4c2e-bd00-6328215131bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf86564230>]}
[0m13:37:39.607570 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2urbouts'
[0m13:37:39.608426 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:37:39.769737 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:37:39.771196 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:37:39.821536 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:37:39.827248 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:37:43.431262 [info ] [MainThread]: Installed from version 1.1.1
[0m13:37:43.432217 [info ] [MainThread]: Updated version available: 1.3.0
[0m13:37:43.433263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a0ba3400-8bf4-4c2e-bd00-6328215131bd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf84cec380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf84cefad0>]}
[0m13:37:43.434276 [info ] [MainThread]: 
[0m13:37:43.435050 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:37:43.437142 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.5529246, "process_user_time": 1.678993, "process_kernel_time": 0.389766, "process_mem_max_rss": "96016", "process_out_blocks": "200", "process_in_blocks": "0"}
[0m13:37:43.438075 [debug] [MainThread]: Command `dbt deps` succeeded at 13:37:43.437909 after 4.55 seconds
[0m13:37:43.438720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf852ac1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf84d67ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf859634a0>]}
[0m13:37:43.439295 [debug] [MainThread]: Flushing usage events
[0m13:38:02.914413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7d2e9d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7d5600fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7d355ee10>]}


============================== 13:38:02.916714 | e6400700-4a1d-413d-985e-d316b67e2348 ==============================
[0m13:38:02.916714 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:38:02.917594 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None', 'empty': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'partial_parse': 'True', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'indirect_selection': 'eager'}
[0m13:38:04.640719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6400700-4a1d-413d-985e-d316b67e2348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b4add1f0>]}
[0m13:38:04.694453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6400700-4a1d-413d-985e-d316b67e2348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b7b24980>]}
[0m13:38:04.695811 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m13:38:04.734633 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:38:05.570307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:38:05.570994 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:38:05.684933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6400700-4a1d-413d-985e-d316b67e2348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7d41e34d0>]}
[0m13:38:05.818815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6400700-4a1d-413d-985e-d316b67e2348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b4aa7b30>]}
[0m13:38:05.819723 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m13:38:05.820570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6400700-4a1d-413d-985e-d316b67e2348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b53d91c0>]}
[0m13:38:05.823461 [info ] [MainThread]: 
[0m13:38:05.825060 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:38:05.831296 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m13:38:05.832250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:06.675056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m13:38:06.676014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:07.331666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6400700-4a1d-413d-985e-d316b67e2348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b4b1fbf0>]}
[0m13:38:07.332846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:07.338983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:38:07.339936 [info ] [MainThread]: 
[0m13:38:07.343664 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:38:07.344734 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m13:38:07.345614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m13:38:07.346409 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:38:07.372872 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:38:07.386129 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:38:07.429632 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:38:07.444363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:07.451602 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m13:38:08.445176 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:c152abe0-c4ef-403f-8317-470bc5589d80&page=queryresults
[0m13:38:08.446818 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:c152abe0-c4ef-403f-8317-470bc5589d80&page=queryresults
[0m13:38:08.473899 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  Not found: Table airflow-tutorial-437816:retail.country was not found in location US
  compiled code at target/run/retail/models/transform/dim_customer.sql
[0m13:38:08.475950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6400700-4a1d-413d-985e-d316b67e2348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b4a168a0>]}
[0m13:38:08.476952 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model retail.dim_customer ...................... [[31mERROR[0m in 1.13s]
[0m13:38:08.478131 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:38:08.479912 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:38:08.481943 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m13:38:08.482973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:38:08.483677 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:38:08.489709 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:38:08.498860 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:38:08.503015 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:38:08.511968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:08.517925 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 14 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 12 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m13:38:09.650373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:01425f32-7f5d-47a8-812d-c3afd9b126a4&page=queryresults
[0m13:38:12.770143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6400700-4a1d-413d-985e-d316b67e2348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b47725a0>]}
[0m13:38:12.779894 [info ] [Thread-1 (]: 2 of 4 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (23.3k rows, 8.8 MiB processed)[0m in 4.29s]
[0m13:38:12.783014 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:38:12.784902 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:38:12.785801 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m13:38:12.786754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:38:12.787510 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:38:12.793209 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:38:12.801566 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:38:12.806450 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:38:12.814848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:12.818302 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m13:38:13.746179 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:49b658d2-c739-47d2-ae46-d7b432130d9f&page=queryresults
[0m13:38:17.032211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6400700-4a1d-413d-985e-d316b67e2348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b42e6c30>]}
[0m13:38:17.034420 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.24s]
[0m13:38:17.036268 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:38:17.039745 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:38:17.041239 [info ] [Thread-1 (]: 4 of 4 SKIP relation retail.fct_invoices ....................................... [[33mSKIP[0m]
[0m13:38:17.043213 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:38:17.049390 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:17.067991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:17.069420 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m13:38:17.070678 [info ] [MainThread]: 
[0m13:38:17.072366 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.25 seconds (11.25s).
[0m13:38:17.076237 [debug] [MainThread]: Command end result
[0m13:38:17.209647 [info ] [MainThread]: 
[0m13:38:17.214813 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:38:17.216641 [info ] [MainThread]: 
[0m13:38:17.218293 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  Not found: Table airflow-tutorial-437816:retail.country was not found in location US
  compiled code at target/run/retail/models/transform/dim_customer.sql
[0m13:38:17.221095 [info ] [MainThread]: 
[0m13:38:17.223350 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m13:38:17.226867 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.38225, "process_user_time": 4.242383, "process_kernel_time": 0.770432, "process_mem_max_rss": "236916", "process_in_blocks": "16", "command_success": false, "process_out_blocks": "0"}
[0m13:38:17.229765 [debug] [MainThread]: Command `dbt run` failed at 13:38:17.229194 after 14.39 seconds
[0m13:38:17.231897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b4842750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b49ffd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7b4751a90>]}
[0m13:38:17.233274 [debug] [MainThread]: Flushing usage events
[0m13:39:00.858635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3628b29460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362a159280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3628ba4bf0>]}


============================== 13:39:00.863285 | 7aa54155-8b33-4d46-9ee0-3ddbcb3db1db ==============================
[0m13:39:00.863285 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:39:00.864545 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'write_json': 'True', 'empty': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'use_colors': 'True', 'version_check': 'True'}
[0m13:39:01.949810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7aa54155-8b33-4d46-9ee0-3ddbcb3db1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3606b751f0>]}
[0m13:39:02.013313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7aa54155-8b33-4d46-9ee0-3ddbcb3db1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36287daa50>]}
[0m13:39:02.014773 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m13:39:02.054394 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:39:03.295520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:39:03.296571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:39:03.466543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7aa54155-8b33-4d46-9ee0-3ddbcb3db1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3605c8ee10>]}
[0m13:39:03.635260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7aa54155-8b33-4d46-9ee0-3ddbcb3db1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3605da81a0>]}
[0m13:39:03.636702 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m13:39:03.637954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aa54155-8b33-4d46-9ee0-3ddbcb3db1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3606219700>]}
[0m13:39:03.640911 [info ] [MainThread]: 
[0m13:39:03.642359 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:39:03.648144 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m13:39:03.649360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:04.307797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m13:39:04.308698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:04.959506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aa54155-8b33-4d46-9ee0-3ddbcb3db1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362994c770>]}
[0m13:39:04.960991 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:04.966807 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:04.967712 [info ] [MainThread]: 
[0m13:39:04.971349 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:39:04.972287 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m13:39:04.973185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m13:39:04.973802 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:39:05.000236 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:39:05.011618 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:39:05.056489 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:39:05.066992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:05.070255 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m13:39:06.012280 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:173d9a48-8580-4c7b-8769-2363f32b0b2d&page=queryresults
[0m13:39:09.359704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aa54155-8b33-4d46-9ee0-3ddbcb3db1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3606dd3aa0>]}
[0m13:39:09.360913 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.39s]
[0m13:39:09.362611 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:39:09.363860 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:39:09.364672 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m13:39:09.365564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:39:09.366342 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:39:09.370053 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:39:09.379304 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:39:09.383571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:10.076179 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:39:10.086452 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 14 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 12 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m13:39:10.710920 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:2045e44f-69db-4e00-8fa7-ec857fd2fd8e&page=queryresults
[0m13:39:13.954901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aa54155-8b33-4d46-9ee0-3ddbcb3db1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3606136c60>]}
[0m13:39:13.957317 [info ] [Thread-1 (]: 2 of 4 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (23.3k rows, 8.8 MiB processed)[0m in 4.59s]
[0m13:39:13.959670 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:39:13.961230 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:39:13.962384 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m13:39:13.965595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:39:13.967904 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:39:13.976152 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:39:13.987401 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:39:13.991008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:14.679149 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:39:14.694605 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m13:39:15.388394 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:a2630e09-f183-4243-a6f5-e8d6dddaa56b&page=queryresults
[0m13:39:18.660139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aa54155-8b33-4d46-9ee0-3ddbcb3db1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3605f569c0>]}
[0m13:39:18.661405 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.69s]
[0m13:39:18.662784 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:39:18.664532 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:39:18.665305 [info ] [Thread-1 (]: 4 of 4 START sql table model retail.fct_invoices ............................... [RUN]
[0m13:39:18.666025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_product, now model.retail.fct_invoices)
[0m13:39:18.666803 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m13:39:18.674977 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m13:39:18.684603 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m13:39:18.688325 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m13:39:18.697491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:18.701796 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`fct_invoices`
      
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql

-- Create the fact table by joining the relevant keys from dimension table
WITH fct_invoices_cte AS (
    SELECT
        InvoiceNo AS invoice_id,
        InvoiceDate AS datetime_id,
        to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
        to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
        Quantity AS quantity,
        Quantity * UnitPrice AS total
    FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
    WHERE Quantity > 0
)
SELECT
    invoice_id,
    dt.datetime_id,
    dp.product_id,
    dc.customer_id,
    quantity,
    total
FROM fct_invoices_cte fi
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_product` dp ON fi.product_id = dp.product_id
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_customer` dc ON fi.customer_id = dc.customer_id
    );
  
[0m13:39:19.645678 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:86834243-0313-4c16-af29-f67e901005c0&page=queryresults
[0m13:39:27.167831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aa54155-8b33-4d46-9ee0-3ddbcb3db1db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3605d01460>]}
[0m13:39:27.169110 [info ] [Thread-1 (]: 4 of 4 OK created sql table model retail.fct_invoices .......................... [[32mCREATE TABLE (397.9k rows, 51.7 MiB processed)[0m in 8.50s]
[0m13:39:27.170485 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:39:27.172796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:27.176711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:27.177486 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m13:39:27.178272 [info ] [MainThread]: 
[0m13:39:27.178939 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 23.54 seconds (23.54s).
[0m13:39:27.180850 [debug] [MainThread]: Command end result
[0m13:39:27.263288 [info ] [MainThread]: 
[0m13:39:27.264743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:27.265840 [info ] [MainThread]: 
[0m13:39:27.267095 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:39:27.269402 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.478897, "process_user_time": 4.225982, "process_kernel_time": 0.342919, "process_mem_max_rss": "231192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:39:27.270744 [debug] [MainThread]: Command `dbt run` succeeded at 13:39:27.270499 after 26.48 seconds
[0m13:39:27.271735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3628494a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362818cf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3604096ff0>]}
[0m13:39:27.272585 [debug] [MainThread]: Flushing usage events
[0m14:19:24.914176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fea524bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fea410290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1feb207d40>]}


============================== 14:19:24.918986 | 4ff3163d-d215-4e74-808b-0f705e554889 ==============================
[0m14:19:24.918986 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:19:24.920489 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'write_json': 'True', 'invocation_command': 'dbt deps', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'quiet': 'False', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'no_print': 'None', 'fail_fast': 'False'}
[0m14:19:25.109032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ff3163d-d215-4e74-808b-0f705e554889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe9e03470>]}
[0m14:19:25.828187 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: 'dbt_packages/dbt_utils'
[0m14:19:25.844179 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/cli/main.py", line 447, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt/task/deps.py", line 233, in run
    system.rmtree(self.project.packages_install_path)
  File "/usr/local/airflow/dbt_venv/lib/python3.12/site-packages/dbt_common/clients/system.py", line 715, in rmtree
    return shutil.rmtree(path, onerror=chmod_and_retry)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 759, in rmtree
    _rmtree_safe_fd(stack, onexc)
  File "/usr/local/lib/python3.12/shutil.py", line 703, in _rmtree_safe_fd
    onexc(func, path, err)
  File "/usr/local/lib/python3.12/shutil.py", line 750, in onexc
    return onerror(func, path, exc_info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 662, in _rmtree_safe_fd
    os.rmdir(name, dir_fd=dirfd)
PermissionError: [Errno 13] Permission denied: 'dbt_packages/dbt_utils'

[0m14:19:25.878726 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 1.0624471, "process_user_time": 1.865005, "process_kernel_time": 1.246771, "process_mem_max_rss": "95688", "process_in_blocks": "248", "command_success": false, "process_out_blocks": "0"}
[0m14:19:25.880164 [debug] [MainThread]: Command `dbt deps` failed at 14:19:25.879838 after 1.06 seconds
[0m14:19:25.881211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1feafe8d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe9e45820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fe9ebf6b0>]}
[0m14:19:25.882476 [debug] [MainThread]: Flushing usage events
[0m14:19:53.562861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b766ee8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b77052540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b766eea50>]}


============================== 14:19:53.565287 | 3e1e06c2-7396-4abf-af9e-419ce6ad1769 ==============================
[0m14:19:53.565287 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:19:53.566134 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'invocation_command': 'dbt deps', 'debug': 'False', 'empty': 'None', 'log_format': 'default', 'quiet': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'introspect': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt'}
[0m14:19:53.681621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e1e06c2-7396-4abf-af9e-419ce6ad1769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b77bd07a0>]}
[0m14:19:53.729253 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l_vhzkss'
[0m14:19:53.730068 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:19:53.971491 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:19:53.972905 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:19:54.079695 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:19:54.085947 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:19:57.704454 [info ] [MainThread]: Installed from version 1.1.1
[0m14:19:57.705368 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:19:57.706293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3e1e06c2-7396-4abf-af9e-419ce6ad1769', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b764f3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b764f3950>]}
[0m14:19:57.707095 [info ] [MainThread]: 
[0m14:19:57.707866 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:19:57.710397 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.2163587, "process_user_time": 1.569313, "process_kernel_time": 0.417159, "process_mem_max_rss": "96004", "process_out_blocks": "200", "process_in_blocks": "0"}
[0m14:19:57.711526 [debug] [MainThread]: Command `dbt deps` succeeded at 14:19:57.711345 after 4.22 seconds
[0m14:19:57.712253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b766ef530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b775d29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b764ba3c0>]}
[0m14:19:57.713226 [debug] [MainThread]: Flushing usage events
[0m14:20:05.475860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e02de270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e0989190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e038b920>]}


============================== 14:20:05.478237 | edc8f407-e8ed-4130-b222-72af77575899 ==============================
[0m14:20:05.478237 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:20:05.479212 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'use_experimental_parser': 'False', 'debug': 'False', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'static_parser': 'True', 'log_format': 'default', 'write_json': 'True'}
[0m14:20:08.250962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edc8f407-e8ed-4130-b222-72af77575899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c492d1f0>]}
[0m14:20:08.344434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edc8f407-e8ed-4130-b222-72af77575899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79be9c0a70>]}
[0m14:20:08.345668 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m14:20:08.396316 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:20:09.448749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:09.449615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:09.617047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edc8f407-e8ed-4130-b222-72af77575899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79bdb48140>]}
[0m14:20:09.769393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edc8f407-e8ed-4130-b222-72af77575899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79bda84170>]}
[0m14:20:09.770383 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m14:20:09.771436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edc8f407-e8ed-4130-b222-72af77575899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79bdaa8590>]}
[0m14:20:09.774792 [info ] [MainThread]: 
[0m14:20:09.776358 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:20:09.781916 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m14:20:09.782896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:10.746765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m14:20:10.747545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:11.482778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edc8f407-e8ed-4130-b222-72af77575899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79bdc90560>]}
[0m14:20:11.483884 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:11.491773 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:20:11.492885 [info ] [MainThread]: 
[0m14:20:11.499242 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:20:11.500826 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m14:20:11.502206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m14:20:11.503396 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:20:11.535624 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:20:11.553275 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:20:11.621212 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:20:11.665228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:11.671894 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m14:20:13.024707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:02d6d9e3-e99e-4551-9b7e-62b1d15dfe4a&page=queryresults
[0m14:20:16.096803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc8f407-e8ed-4130-b222-72af77575899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79be8feb40>]}
[0m14:20:16.098357 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 4.59s]
[0m14:20:16.100018 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:20:16.101146 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:20:16.102576 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m14:20:16.104670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:20:16.106241 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:20:16.112021 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:20:16.126129 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:20:16.130026 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:20:16.142690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:16.146431 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 14 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 12 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m14:20:17.044304 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:5af80509-6ed9-4ebd-86e2-ce1ed8c71bf1&page=queryresults
[0m14:20:20.091512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc8f407-e8ed-4130-b222-72af77575899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79af664f20>]}
[0m14:20:20.092792 [info ] [Thread-1 (]: 2 of 4 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (23.3k rows, 7.7 MiB processed)[0m in 3.99s]
[0m14:20:20.094026 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:20:20.095088 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:20:20.096042 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m14:20:20.096896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:20:20.097579 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:20:20.104317 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:20:20.114208 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:20:20.119949 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:20:20.133062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:20.140654 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m14:20:21.064025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:47d9b79c-e485-4b1a-833a-474f83f20bab&page=queryresults
[0m14:20:24.656473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc8f407-e8ed-4130-b222-72af77575899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79af50e9f0>]}
[0m14:20:24.657752 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 4.56s]
[0m14:20:24.658793 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:20:24.660538 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:20:24.661489 [info ] [Thread-1 (]: 4 of 4 START sql table model retail.fct_invoices ............................... [RUN]
[0m14:20:24.662530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_product, now model.retail.fct_invoices)
[0m14:20:24.663446 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m14:20:24.672651 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m14:20:24.680238 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m14:20:24.685143 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m14:20:24.695322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:24.699885 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`fct_invoices`
      
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql

-- Create the fact table by joining the relevant keys from dimension table
WITH fct_invoices_cte AS (
    SELECT
        InvoiceNo AS invoice_id,
        InvoiceDate AS datetime_id,
        to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
        to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
        Quantity AS quantity,
        Quantity * UnitPrice AS total
    FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
    WHERE Quantity > 0
)
SELECT
    invoice_id,
    dt.datetime_id,
    dp.product_id,
    dc.customer_id,
    quantity,
    total
FROM fct_invoices_cte fi
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_product` dp ON fi.product_id = dp.product_id
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_customer` dc ON fi.customer_id = dc.customer_id
    );
  
[0m14:20:25.615765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:e1aba049-6f52-4c82-a35b-750a45cb4b09&page=queryresults
[0m14:20:31.661643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edc8f407-e8ed-4130-b222-72af77575899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79bd9e7cb0>]}
[0m14:20:31.663030 [info ] [Thread-1 (]: 4 of 4 OK created sql table model retail.fct_invoices .......................... [[32mCREATE TABLE (397.9k rows, 50.6 MiB processed)[0m in 7.00s]
[0m14:20:31.664169 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:20:31.666534 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:20:31.671058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:31.672123 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m14:20:31.672990 [info ] [MainThread]: 
[0m14:20:31.673703 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 21.90 seconds (21.90s).
[0m14:20:31.675797 [debug] [MainThread]: Command end result
[0m14:20:31.751295 [info ] [MainThread]: 
[0m14:20:31.753542 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:31.756078 [info ] [MainThread]: 
[0m14:20:31.757837 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:20:31.759606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.379143, "process_user_time": 5.029423, "process_kernel_time": 1.311132, "process_mem_max_rss": "235348", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:20:31.760709 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:31.760482 after 26.38 seconds
[0m14:20:31.761570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79e03c81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79bdd106b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79af533fb0>]}
[0m14:20:31.762228 [debug] [MainThread]: Flushing usage events
[0m14:21:47.067008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d7a6ae810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d7a976300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d7b550f50>]}


============================== 14:21:47.081478 | 67e28dfc-b2ae-49c8-b998-b8ce3ef2f283 ==============================
[0m14:21:47.081478 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:21:47.082703 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_format': 'default', 'empty': 'False', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'printer_width': '80', 'log_cache_events': 'False', 'write_json': 'True'}
[0m14:21:48.892166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67e28dfc-b2ae-49c8-b998-b8ce3ef2f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5c3393a0>]}
[0m14:21:48.967830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67e28dfc-b2ae-49c8-b998-b8ce3ef2f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d7b550ec0>]}
[0m14:21:48.969069 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m14:21:49.016586 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:21:50.029106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:21:50.030263 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m14:21:50.523123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67e28dfc-b2ae-49c8-b998-b8ce3ef2f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5c2c20f0>]}
[0m14:21:50.765865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67e28dfc-b2ae-49c8-b998-b8ce3ef2f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5702f950>]}
[0m14:21:50.766886 [info ] [MainThread]: Found 4 models, 2 sources, 596 macros
[0m14:21:50.767924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e28dfc-b2ae-49c8-b998-b8ce3ef2f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5cd55df0>]}
[0m14:21:50.772089 [info ] [MainThread]: 
[0m14:21:50.774012 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:21:50.780977 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m14:21:50.783471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:51.536137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m14:21:51.538610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:52.340139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e28dfc-b2ae-49c8-b998-b8ce3ef2f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5c2c1f70>]}
[0m14:21:52.341544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:21:52.348356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:21:52.349918 [info ] [MainThread]: 
[0m14:21:52.356684 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:21:52.359142 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m14:21:52.360810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m14:21:52.362149 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:21:52.418755 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:21:52.439216 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:21:52.480484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:53.336129 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:21:53.350152 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m14:21:53.964070 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:58de9232-c0c3-4dbd-875d-2c549d70b33b&page=queryresults
[0m14:21:57.833407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e28dfc-b2ae-49c8-b998-b8ce3ef2f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d5cec7320>]}
[0m14:21:57.834759 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 5.47s]
[0m14:21:57.836139 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:21:57.837732 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:21:57.840123 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m14:21:57.841852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:21:57.843772 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:21:57.849749 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:21:57.867262 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:21:57.874401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:58.596547 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:21:58.612751 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m14:21:59.269186 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:99968441-1ce2-4e11-a38a-cc945a229cd9&page=queryresults
[0m14:22:04.922659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e28dfc-b2ae-49c8-b998-b8ce3ef2f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d54f151f0>]}
[0m14:22:04.928913 [info ] [Thread-1 (]: 2 of 4 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (23.3k rows, 7.7 MiB processed)[0m in 7.08s]
[0m14:22:04.931967 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:22:04.936860 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:22:04.938883 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m14:22:04.941538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:22:04.943255 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:22:04.954499 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:22:04.965780 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:22:04.972214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:06.489520 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:22:06.505353 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m14:22:07.729701 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:3dd47292-ad12-41bb-826b-d8b04f449ccd&page=queryresults
[0m14:22:14.243772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e28dfc-b2ae-49c8-b998-b8ce3ef2f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d54f14ad0>]}
[0m14:22:14.247648 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 9.30s]
[0m14:22:14.249534 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:22:14.251917 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:22:14.253720 [info ] [Thread-1 (]: 4 of 4 START sql table model retail.fct_invoices ............................... [RUN]
[0m14:22:14.255334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_product, now model.retail.fct_invoices)
[0m14:22:14.256704 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m14:22:14.273412 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m14:22:14.292213 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m14:22:14.297421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:15.062188 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m14:22:15.074126 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`fct_invoices`
      
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql

-- Create the fact table by joining the relevant keys from dimension table
WITH fct_invoices_cte AS (
    SELECT
        InvoiceNo AS invoice_id,
        InvoiceDate AS datetime_id,
        to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
        to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
        Quantity AS quantity,
        Quantity * UnitPrice AS total
    FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
    WHERE Quantity > 0
)
SELECT
    invoice_id,
    dt.datetime_id,
    dp.product_id,
    dc.customer_id,
    quantity,
    total
FROM fct_invoices_cte fi
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_product` dp ON fi.product_id = dp.product_id
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_customer` dc ON fi.customer_id = dc.customer_id
    );
  
[0m14:22:15.707548 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:4e269ea9-af78-485f-8e0a-9e9f41841994&page=queryresults
[0m14:22:24.333706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e28dfc-b2ae-49c8-b998-b8ce3ef2f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d54cba240>]}
[0m14:22:24.334982 [info ] [Thread-1 (]: 4 of 4 OK created sql table model retail.fct_invoices .......................... [[32mCREATE TABLE (397.9k rows, 50.6 MiB processed)[0m in 10.08s]
[0m14:22:24.337197 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:22:24.340704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:24.347194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:24.348036 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m14:22:24.349082 [info ] [MainThread]: 
[0m14:22:24.349796 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 33.58 seconds (33.58s).
[0m14:22:24.352547 [debug] [MainThread]: Command end result
[0m14:22:24.433322 [info ] [MainThread]: 
[0m14:22:24.434560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:24.436468 [info ] [MainThread]: 
[0m14:22:24.438548 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:22:24.442376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 37.46035, "process_user_time": 5.464516, "process_kernel_time": 0.956544, "process_mem_max_rss": "237984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:22:24.443728 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:24.443542 after 37.46 seconds
[0m14:22:24.444480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d54df3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d54ce8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d54ce8530>]}
[0m14:22:24.445315 [debug] [MainThread]: Flushing usage events
[0m09:55:07.135069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c8ff99520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c8e9d1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c8e5e6360>]}


============================== 09:55:07.138421 | ee203e81-98f8-42d7-bfc5-af5e78a89287 ==============================
[0m09:55:07.138421 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:55:07.139357 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'introspect': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'fail_fast': 'False', 'empty': 'None', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'invocation_command': 'dbt deps'}
[0m09:55:07.293279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee203e81-98f8-42d7-bfc5-af5e78a89287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c8de91c40>]}
[0m09:55:07.343628 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ot4ld6y3'
[0m09:55:07.344801 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:55:07.854753 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:55:07.856386 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:55:07.907976 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:55:07.922726 [info ] [MainThread]: Updating lock file in file path: /usr/local/airflow/include/dbt/package-lock.yml
[0m09:55:08.301829 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h3fdrhyo'
[0m09:55:08.305797 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:55:12.112260 [info ] [MainThread]: Installed from version 1.3.0
[0m09:55:12.113100 [info ] [MainThread]: Up to date!
[0m09:55:12.114032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ee203e81-98f8-42d7-bfc5-af5e78a89287', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c8e9d1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c8e036270>]}
[0m09:55:12.120835 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.0537825, "process_user_time": 1.812504, "process_kernel_time": 1.39735, "process_mem_max_rss": "95936", "process_in_blocks": "46072", "process_out_blocks": "176"}
[0m09:55:12.121866 [debug] [MainThread]: Command `dbt deps` succeeded at 09:55:12.121666 after 5.05 seconds
[0m09:55:12.122483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c8e5c11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c8e9d1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c8e036270>]}
[0m09:55:12.123035 [debug] [MainThread]: Flushing usage events
[0m09:57:35.414036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdf2d2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece1404500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdf968470>]}


============================== 09:57:35.417179 | 20fec2fb-ca70-496d-bfd4-a34663ba9c3f ==============================
[0m09:57:35.417179 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:57:35.418210 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'introspect': 'True', 'empty': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m09:57:37.795180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20fec2fb-ca70-496d-bfd4-a34663ba9c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc0f0f1d0>]}
[0m09:57:37.864212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20fec2fb-ca70-496d-bfd4-a34663ba9c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc19cbb30>]}
[0m09:57:37.865829 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m09:57:37.910273 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:57:38.889395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
[0m09:57:38.890391 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m09:57:38.891114 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/equality.sql
[0m09:57:38.891698 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/unpivot.sql
[0m09:57:38.892261 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m09:57:38.892995 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m09:57:38.893626 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m09:57:38.894169 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/deduplicate.sql
[0m09:57:39.196991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20fec2fb-ca70-496d-bfd4-a34663ba9c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc08521b0>]}
[0m09:57:39.356930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20fec2fb-ca70-496d-bfd4-a34663ba9c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc0b49d90>]}
[0m09:57:39.357968 [info ] [MainThread]: Found 4 models, 2 sources, 598 macros
[0m09:57:39.359235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20fec2fb-ca70-496d-bfd4-a34663ba9c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecded17140>]}
[0m09:57:39.362099 [info ] [MainThread]: 
[0m09:57:39.363551 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:57:39.371575 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m09:57:39.372988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:40.303513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m09:57:40.304939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:41.032895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20fec2fb-ca70-496d-bfd4-a34663ba9c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece0324860>]}
[0m09:57:41.034459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:41.042211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:41.043212 [info ] [MainThread]: 
[0m09:57:41.054137 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:57:41.055833 [info ] [Thread-1 (]: 1 of 4 START sql table model retail.dim_customer ............................... [RUN]
[0m09:57:41.058427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.dim_customer)
[0m09:57:41.060511 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:57:41.124028 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:57:41.135185 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:57:41.163272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:42.028711 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:57:42.043704 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_customer`
      
    
    

    OPTIONS()
    as (
      -- dim_customer.sql

-- Create the dimension table
WITH customer_cte AS (
	SELECT DISTINCT
	    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
	    Country AS country
	FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN `airflow-tutorial-437816`.`retail`.`country` cm ON t.country = cm.nicename
    );
  
[0m09:57:42.804122 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:e96b981c-322d-4eb1-8fa2-bcba48fb0ff3&page=queryresults
[0m09:57:47.032828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20fec2fb-ca70-496d-bfd4-a34663ba9c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc17dad80>]}
[0m09:57:47.037511 [info ] [Thread-1 (]: 1 of 4 OK created sql table model retail.dim_customer .......................... [[32mCREATE TABLE (4.4k rows, 11.1 MiB processed)[0m in 5.97s]
[0m09:57:47.046983 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:57:47.052136 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m09:57:47.056523 [info ] [Thread-1 (]: 2 of 4 START sql table model retail.dim_datetime ............................... [RUN]
[0m09:57:47.059583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m09:57:47.061702 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m09:57:47.082903 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m09:57:47.103910 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m09:57:47.112030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:47.871578 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m09:57:47.895341 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_datetime`
      
    
    

    OPTIONS()
    as (
      -- dim_datetime.sql

-- Create a CTE to extract date and time components
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
    );
  
[0m09:57:48.510824 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:09b3807e-eb61-49f0-986c-81d49c783e49&page=queryresults
[0m09:57:52.018981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20fec2fb-ca70-496d-bfd4-a34663ba9c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecba5caf30>]}
[0m09:57:52.022493 [info ] [Thread-1 (]: 2 of 4 OK created sql table model retail.dim_datetime .......................... [[32mCREATE TABLE (23.3k rows, 7.7 MiB processed)[0m in 4.96s]
[0m09:57:52.034353 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m09:57:52.036438 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m09:57:52.038232 [info ] [Thread-1 (]: 3 of 4 START sql table model retail.dim_product ................................ [RUN]
[0m09:57:52.039806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m09:57:52.041353 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m09:57:52.055618 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m09:57:52.077667 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m09:57:52.085505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:52.886291 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m09:57:52.897042 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`dim_product`
      
    
    

    OPTIONS()
    as (
      -- dim_product.sql
-- StockCode isn't unique, a product with the same id can have different and prices
-- Create the dimension table
SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
    );
  
[0m09:57:53.462961 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:b7ee49e1-409a-4c7a-af93-2ed1aff64b2a&page=queryresults
[0m09:57:57.054505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20fec2fb-ca70-496d-bfd4-a34663ba9c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecba5a8a40>]}
[0m09:57:57.055943 [info ] [Thread-1 (]: 3 of 4 OK created sql table model retail.dim_product ........................... [[32mCREATE TABLE (16.3k rows, 22.6 MiB processed)[0m in 5.01s]
[0m09:57:57.057442 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m09:57:57.061139 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m09:57:57.062283 [info ] [Thread-1 (]: 4 of 4 START sql table model retail.fct_invoices ............................... [RUN]
[0m09:57:57.063553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_product, now model.retail.fct_invoices)
[0m09:57:57.064649 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m09:57:57.077046 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m09:57:57.088964 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m09:57:57.092976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:57.934001 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m09:57:57.942252 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`fct_invoices`
      
    
    

    OPTIONS()
    as (
      -- fct_invoices.sql

-- Create the fact table by joining the relevant keys from dimension table
WITH fct_invoices_cte AS (
    SELECT
        InvoiceNo AS invoice_id,
        InvoiceDate AS datetime_id,
        to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,
        to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,
        Quantity AS quantity,
        Quantity * UnitPrice AS total
    FROM `airflow-tutorial-437816`.`retail`.`raw_invoices`
    WHERE Quantity > 0
)
SELECT
    invoice_id,
    dt.datetime_id,
    dp.product_id,
    dc.customer_id,
    quantity,
    total
FROM fct_invoices_cte fi
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_product` dp ON fi.product_id = dp.product_id
INNER JOIN `airflow-tutorial-437816`.`retail`.`dim_customer` dc ON fi.customer_id = dc.customer_id
    );
  
[0m09:57:58.534786 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:63f477ba-a1b7-47f7-97e2-ff290359c0de&page=queryresults
[0m09:58:03.960746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20fec2fb-ca70-496d-bfd4-a34663ba9c3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecba4a19a0>]}
[0m09:58:03.962538 [info ] [Thread-1 (]: 4 of 4 OK created sql table model retail.fct_invoices .......................... [[32mCREATE TABLE (397.9k rows, 50.6 MiB processed)[0m in 6.90s]
[0m09:58:03.964592 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m09:58:03.968082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:58:03.974952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:03.976148 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m09:58:03.977381 [info ] [MainThread]: 
[0m09:58:03.978459 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 24.61 seconds (24.61s).
[0m09:58:03.982591 [debug] [MainThread]: Command end result
[0m09:58:04.080188 [info ] [MainThread]: 
[0m09:58:04.082575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:58:04.083990 [info ] [MainThread]: 
[0m09:58:04.086748 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:58:04.099990 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 28.754004, "process_user_time": 4.943481, "process_kernel_time": 1.618046, "process_mem_max_rss": "236928", "process_in_blocks": "178528", "process_out_blocks": "0"}
[0m09:58:04.102616 [debug] [MainThread]: Command `dbt run` succeeded at 09:58:04.102215 after 28.76 seconds
[0m09:58:04.104699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdefc2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc0e72960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecba464ce0>]}
[0m09:58:04.106038 [debug] [MainThread]: Flushing usage events
[0m10:47:11.701499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca747cd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7793c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca747cc680>]}


============================== 10:47:11.707530 | eb9cf5fd-0ee2-4c12-8dec-a91bce2f3f6d ==============================
[0m10:47:11.707530 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:47:11.708966 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /usr/local/airflow/include/dbt/', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'log_format': 'default', 'target_path': 'None', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False'}
[0m10:47:18.077513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb9cf5fd-0ee2-4c12-8dec-a91bce2f3f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7432af60>]}
[0m10:47:18.171887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb9cf5fd-0ee2-4c12-8dec-a91bce2f3f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca51dcc0b0>]}
[0m10:47:18.173175 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m10:47:18.255920 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:47:19.622192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:47:19.623066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:47:19.756949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb9cf5fd-0ee2-4c12-8dec-a91bce2f3f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca51c602f0>]}
[0m10:47:19.941032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb9cf5fd-0ee2-4c12-8dec-a91bce2f3f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca518b9130>]}
[0m10:47:19.942232 [info ] [MainThread]: Found 4 models, 2 sources, 598 macros
[0m10:47:19.943022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb9cf5fd-0ee2-4c12-8dec-a91bce2f3f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca73ddbc80>]}
[0m10:47:19.946828 [info ] [MainThread]: 
[0m10:47:19.948284 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:47:19.952639 [debug] [MainThread]: Command end result
[0m10:47:20.041565 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.447352, "process_user_time": 5.007342, "process_kernel_time": 4.769369, "process_mem_max_rss": "210112", "process_in_blocks": "43200", "process_out_blocks": "0"}
[0m10:47:20.042739 [debug] [MainThread]: Command `dbt test` succeeded at 10:47:20.042556 after 8.45 seconds
[0m10:47:20.043684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca76829340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca74690470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca51ce3b00>]}
[0m10:47:20.044656 [debug] [MainThread]: Flushing usage events
[0m18:59:28.554731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8802fe300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8818013a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87fcfa9f0>]}


============================== 18:59:28.560121 | cf1c79bc-2f0f-424c-85b4-d252e9d1297f ==============================
[0m18:59:28.560121 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:59:28.561558 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt deps', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'debug': 'False', 'target_path': 'None'}
[0m18:59:28.880037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf1c79bc-2f0f-424c-85b4-d252e9d1297f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87fab20c0>]}
[0m18:59:29.597693 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-s7nst7dj'
[0m18:59:29.598909 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:59:29.887975 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:59:29.891528 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:59:29.967632 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:59:29.981523 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:59:41.963059 [info ] [MainThread]: Installed from version 1.3.0
[0m18:59:41.968793 [info ] [MainThread]: Up to date!
[0m18:59:41.971319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cf1c79bc-2f0f-424c-85b4-d252e9d1297f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87f73e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87f73cdd0>]}
[0m18:59:41.979080 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 13.524049, "process_user_time": 2.658337, "process_kernel_time": 3.809586, "process_mem_max_rss": "95812", "process_in_blocks": "55288", "process_out_blocks": "176"}
[0m18:59:41.981318 [debug] [MainThread]: Command `dbt deps` succeeded at 18:59:41.980962 after 13.53 seconds
[0m18:59:41.983441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87fccfe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87f906570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff87fe51d60>]}
[0m18:59:41.985070 [debug] [MainThread]: Flushing usage events
[0m19:01:10.733810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41b23496a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41b1a96cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41b23496d0>]}


============================== 19:01:10.749694 | 4409d2a3-8cc6-4531-b3a5-72a864a5132c ==============================
[0m19:01:10.749694 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:01:10.752894 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'log_format': 'default', 'target_path': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'write_json': 'True', 'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select path:models/report --profiles-dir /usr/local/airflow/include/dbt/'}
[0m19:01:15.753446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4409d2a3-8cc6-4531-b3a5-72a864a5132c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4194205280>]}
[0m19:01:15.920448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4409d2a3-8cc6-4531-b3a5-72a864a5132c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41948392b0>]}
[0m19:01:15.922814 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m19:01:16.017033 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:01:18.352717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m19:01:18.354239 [debug] [MainThread]: Partial parsing: added file: retail://models/report/report_year_invoices.sql
[0m19:01:18.355385 [debug] [MainThread]: Partial parsing: added file: retail://models/report/report_product_invoices.sql
[0m19:01:18.356195 [debug] [MainThread]: Partial parsing: added file: retail://models/report/report_customer_invoices.sql
[0m19:01:18.913150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4409d2a3-8cc6-4531-b3a5-72a864a5132c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418f4af7a0>]}
[0m19:01:19.109296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4409d2a3-8cc6-4531-b3a5-72a864a5132c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418f513590>]}
[0m19:01:19.110388 [info ] [MainThread]: Found 7 models, 2 sources, 598 macros
[0m19:01:19.111281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4409d2a3-8cc6-4531-b3a5-72a864a5132c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418f4e43b0>]}
[0m19:01:19.119939 [info ] [MainThread]: 
[0m19:01:19.121837 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:01:19.130617 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m19:01:19.131789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:20.700412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m19:01:20.701547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:21.557973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4409d2a3-8cc6-4531-b3a5-72a864a5132c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41942b0860>]}
[0m19:01:21.558827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:01:21.562485 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:01:21.563179 [info ] [MainThread]: 
[0m19:01:21.961359 [debug] [Thread-1 (]: Began running node model.retail.report_customer_invoices
[0m19:01:21.962955 [info ] [Thread-1 (]: 1 of 3 START sql table model retail.report_customer_invoices ................... [RUN]
[0m19:01:21.964606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.report_customer_invoices)
[0m19:01:21.965837 [debug] [Thread-1 (]: Began compiling node model.retail.report_customer_invoices
[0m19:01:21.975386 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.report_customer_invoices"
[0m19:01:21.988846 [debug] [Thread-1 (]: Began executing node model.retail.report_customer_invoices
[0m19:01:22.036206 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.report_customer_invoices"
[0m19:01:22.569985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:22.577327 [debug] [Thread-1 (]: On model.retail.report_customer_invoices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.report_customer_invoices"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`report_customer_invoices`
      
    
    

    OPTIONS()
    as (
      -- report_customer_invoices.sql
SELECT
  c.country,
  c.iso,
  COUNT(fi.invoice_id) AS total_invoices,
  SUM(fi.total) AS total_revenue
FROM `airflow-tutorial-437816`.`retail`.`fct_invoices` fi
JOIN `airflow-tutorial-437816`.`retail`.`dim_customer` c ON fi.customer_id = c.customer_id
GROUP BY c.country, c.iso
ORDER BY total_revenue DESC
LIMIT 10
    );
  
[0m19:01:24.566197 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:b9a6b063-475b-4c7b-8f54-5bb8ec832c1d&page=queryresults
[0m19:01:30.373000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4409d2a3-8cc6-4531-b3a5-72a864a5132c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4194436f60>]}
[0m19:01:30.381389 [info ] [Thread-1 (]: 1 of 3 OK created sql table model retail.report_customer_invoices .............. [[32mCREATE TABLE (10.0 rows, 19.2 MiB processed)[0m in 8.40s]
[0m19:01:30.389968 [debug] [Thread-1 (]: Finished running node model.retail.report_customer_invoices
[0m19:01:30.399744 [debug] [Thread-1 (]: Began running node model.retail.report_product_invoices
[0m19:01:30.409982 [info ] [Thread-1 (]: 2 of 3 START sql table model retail.report_product_invoices .................... [RUN]
[0m19:01:30.416024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.report_customer_invoices, now model.retail.report_product_invoices)
[0m19:01:30.427785 [debug] [Thread-1 (]: Began compiling node model.retail.report_product_invoices
[0m19:01:30.483701 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.report_product_invoices"
[0m19:01:30.661062 [debug] [Thread-1 (]: Began executing node model.retail.report_product_invoices
[0m19:01:30.671834 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.report_product_invoices"
[0m19:01:30.856151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:30.961408 [debug] [Thread-1 (]: On model.retail.report_product_invoices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.report_product_invoices"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`report_product_invoices`
      
    
    

    OPTIONS()
    as (
      -- report_product_invoices.sql
SELECT
  p.product_id,
  p.stock_code,
  p.description,
  SUM(fi.quantity) AS total_quantity_sold
FROM `airflow-tutorial-437816`.`retail`.`fct_invoices` fi
JOIN `airflow-tutorial-437816`.`retail`.`dim_product` p ON fi.product_id = p.product_id
GROUP BY p.product_id, p.stock_code, p.description
ORDER BY total_quantity_sold DESC
LIMIT 10-- report_product_invoices.sql
SELECT
  p.product_id,
  p.stock_code,
  p.description,
  SUM(fi.quantity) AS total_quantity_sold
FROM `airflow-tutorial-437816`.`retail`.`fct_invoices` fi
JOIN `airflow-tutorial-437816`.`retail`.`dim_product` p ON fi.product_id = p.product_id
GROUP BY p.product_id, p.stock_code, p.description
ORDER BY total_quantity_sold DESC
LIMIT 10
    );
  
[0m19:01:32.036536 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:a1edea5d-1c44-476a-a5c2-cea56a75cfc7&page=queryresults
[0m19:01:32.041324 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword SELECT at [24:1]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword SELECT at [24:1]')
[0m19:01:32.944648 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:99fad817-f674-4c29-9881-fe5e8f9fb5b0&page=queryresults
[0m19:01:32.946463 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:99fad817-f674-4c29-9881-fe5e8f9fb5b0&page=queryresults
[0m19:01:32.970888 [debug] [Thread-1 (]: Database Error in model report_product_invoices (models/report/report_product_invoices.sql)
  Syntax error: Expected ")" but got keyword SELECT at [24:1]
  compiled code at target/run/retail/models/report/report_product_invoices.sql
[0m19:01:32.972379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4409d2a3-8cc6-4531-b3a5-72a864a5132c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418e3d77a0>]}
[0m19:01:32.974054 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model retail.report_product_invoices ........... [[31mERROR[0m in 2.56s]
[0m19:01:32.976265 [debug] [Thread-1 (]: Finished running node model.retail.report_product_invoices
[0m19:01:32.979126 [debug] [Thread-1 (]: Began running node model.retail.report_year_invoices
[0m19:01:32.987339 [info ] [Thread-1 (]: 3 of 3 START sql table model retail.report_year_invoices ....................... [RUN]
[0m19:01:32.999091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.report_product_invoices, now model.retail.report_year_invoices)
[0m19:01:33.000803 [debug] [Thread-1 (]: Began compiling node model.retail.report_year_invoices
[0m19:01:33.011557 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.report_year_invoices"
[0m19:01:33.032130 [debug] [Thread-1 (]: Began executing node model.retail.report_year_invoices
[0m19:01:33.040488 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.report_year_invoices"
[0m19:01:33.060979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:33.070118 [debug] [Thread-1 (]: On model.retail.report_year_invoices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.report_year_invoices"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`report_year_invoices`
      
    
    

    OPTIONS()
    as (
      -- report_year_invoices.sql
SELECT
  dt.year,
  dt.month,
  COUNT(DISTINCT fi.invoice_id) AS num_invoices,
  SUM(fi.total) AS total_revenue
FROM `airflow-tutorial-437816`.`retail`.`fct_invoices` fi
JOIN `airflow-tutorial-437816`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id
GROUP BY dt.year, dt.month
ORDER BY dt.year, dt.month
    );
  
[0m19:01:34.229386 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:8379c723-a7ce-46ec-b6c2-8564baef3a18&page=queryresults
[0m19:01:37.437184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4409d2a3-8cc6-4531-b3a5-72a864a5132c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f415fe01220>]}
[0m19:01:37.439115 [info ] [Thread-1 (]: 3 of 3 OK created sql table model retail.report_year_invoices .................. [[32mCREATE TABLE (13.0 rows, 12.4 MiB processed)[0m in 4.44s]
[0m19:01:37.440640 [debug] [Thread-1 (]: Finished running node model.retail.report_year_invoices
[0m19:01:37.442871 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:01:37.696759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:37.697898 [debug] [MainThread]: Connection 'model.retail.report_year_invoices' was properly closed.
[0m19:01:37.699039 [info ] [MainThread]: 
[0m19:01:37.699903 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 18.58 seconds (18.58s).
[0m19:01:37.701742 [debug] [MainThread]: Command end result
[0m19:01:38.412241 [info ] [MainThread]: 
[0m19:01:38.413277 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:01:38.414190 [info ] [MainThread]: 
[0m19:01:38.415332 [error] [MainThread]:   Database Error in model report_product_invoices (models/report/report_product_invoices.sql)
  Syntax error: Expected ")" but got keyword SELECT at [24:1]
  compiled code at target/run/retail/models/report/report_product_invoices.sql
[0m19:01:38.416272 [info ] [MainThread]: 
[0m19:01:38.417259 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m19:01:38.498495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 27.902905, "process_user_time": 8.64266, "process_kernel_time": 4.952268, "process_mem_max_rss": "217636", "process_in_blocks": "190544", "command_success": false, "process_out_blocks": "0"}
[0m19:01:39.147915 [debug] [MainThread]: Command `dbt run` failed at 19:01:39.147319 after 28.55 seconds
[0m19:01:39.149059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41b1f65be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41942b0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418f4434a0>]}
[0m19:01:39.149958 [debug] [MainThread]: Flushing usage events
[0m19:01:41.348562 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:03:52.785054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef79b22b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef793c56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef796a4080>]}


============================== 19:03:52.787335 | c8aebbdc-5277-4146-9172-a0d70d7fb3d1 ==============================
[0m19:03:52.787335 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:03:52.788222 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select path:models/report --profiles-dir /usr/local/airflow/include/dbt/', 'introspect': 'True', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'no_print': 'None', 'empty': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'static_parser': 'True', 'partial_parse': 'True'}
[0m19:03:54.278250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8aebbdc-5277-4146-9172-a0d70d7fb3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef5c9b5280>]}
[0m19:03:54.333904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8aebbdc-5277-4146-9172-a0d70d7fb3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef576b40e0>]}
[0m19:03:54.334914 [info ] [MainThread]: Registered adapter: bigquery=1.9.0-b1
[0m19:03:54.369014 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:03:55.216772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:03:55.217781 [debug] [MainThread]: Partial parsing: updated file: retail://models/report/report_product_invoices.sql
[0m19:03:55.559935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8aebbdc-5277-4146-9172-a0d70d7fb3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef56cea090>]}
[0m19:03:55.693433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8aebbdc-5277-4146-9172-a0d70d7fb3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef56edea80>]}
[0m19:03:55.694543 [info ] [MainThread]: Found 7 models, 2 sources, 598 macros
[0m19:03:55.695523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8aebbdc-5277-4146-9172-a0d70d7fb3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef55bb64e0>]}
[0m19:03:55.702618 [info ] [MainThread]: 
[0m19:03:55.703885 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:03:55.711643 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_airflow-tutorial-437816'
[0m19:03:55.712738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:56.727429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816, now list_airflow-tutorial-437816_retail)
[0m19:03:56.728795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:57.753325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8aebbdc-5277-4146-9172-a0d70d7fb3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef57c5c740>]}
[0m19:03:57.754894 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:03:57.761568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:03:57.762821 [info ] [MainThread]: 
[0m19:03:57.769720 [debug] [Thread-1 (]: Began running node model.retail.report_customer_invoices
[0m19:03:57.770823 [info ] [Thread-1 (]: 1 of 3 START sql table model retail.report_customer_invoices ................... [RUN]
[0m19:03:57.771807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow-tutorial-437816_retail, now model.retail.report_customer_invoices)
[0m19:03:57.772758 [debug] [Thread-1 (]: Began compiling node model.retail.report_customer_invoices
[0m19:03:57.782431 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.report_customer_invoices"
[0m19:03:57.793675 [debug] [Thread-1 (]: Began executing node model.retail.report_customer_invoices
[0m19:03:57.815926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:58.744010 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.report_customer_invoices"
[0m19:03:58.752215 [debug] [Thread-1 (]: On model.retail.report_customer_invoices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.report_customer_invoices"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`report_customer_invoices`
      
    
    

    OPTIONS()
    as (
      -- report_customer_invoices.sql
SELECT
  c.country,
  c.iso,
  COUNT(fi.invoice_id) AS total_invoices,
  SUM(fi.total) AS total_revenue
FROM `airflow-tutorial-437816`.`retail`.`fct_invoices` fi
JOIN `airflow-tutorial-437816`.`retail`.`dim_customer` c ON fi.customer_id = c.customer_id
GROUP BY c.country, c.iso
ORDER BY total_revenue DESC
LIMIT 10
    );
  
[0m19:03:59.448529 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:56f7cd22-f064-4cb3-bf52-8bad3e9cd870&page=queryresults
[0m19:04:02.207120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8aebbdc-5277-4146-9172-a0d70d7fb3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef57bdec90>]}
[0m19:04:02.208686 [info ] [Thread-1 (]: 1 of 3 OK created sql table model retail.report_customer_invoices .............. [[32mCREATE TABLE (10.0 rows, 19.2 MiB processed)[0m in 4.43s]
[0m19:04:02.210064 [debug] [Thread-1 (]: Finished running node model.retail.report_customer_invoices
[0m19:04:02.211135 [debug] [Thread-1 (]: Began running node model.retail.report_product_invoices
[0m19:04:02.212073 [info ] [Thread-1 (]: 2 of 3 START sql table model retail.report_product_invoices .................... [RUN]
[0m19:04:02.213028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.report_customer_invoices, now model.retail.report_product_invoices)
[0m19:04:02.213772 [debug] [Thread-1 (]: Began compiling node model.retail.report_product_invoices
[0m19:04:02.217885 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.report_product_invoices"
[0m19:04:02.224494 [debug] [Thread-1 (]: Began executing node model.retail.report_product_invoices
[0m19:04:02.228179 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.report_product_invoices"
[0m19:04:02.236810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:02.242744 [debug] [Thread-1 (]: On model.retail.report_product_invoices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.report_product_invoices"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`report_product_invoices`
      
    
    

    OPTIONS()
    as (
      -- report_product_invoices.sql
SELECT
  p.product_id,
  p.stock_code,
  p.description,
  SUM(fi.quantity) AS total_quantity_sold
FROM `airflow-tutorial-437816`.`retail`.`fct_invoices` fi
JOIN `airflow-tutorial-437816`.`retail`.`dim_product` p ON fi.product_id = p.product_id
GROUP BY p.product_id, p.stock_code, p.description
ORDER BY total_quantity_sold DESC
LIMIT 10
    );
  
[0m19:04:03.188368 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:8a12db96-7a94-489b-b78b-9cd0b6fce4a5&page=queryresults
[0m19:04:06.021981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8aebbdc-5277-4146-9172-a0d70d7fb3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef54157b00>]}
[0m19:04:06.023397 [info ] [Thread-1 (]: 2 of 3 OK created sql table model retail.report_product_invoices ............... [[32mCREATE TABLE (10.0 rows, 17.0 MiB processed)[0m in 3.81s]
[0m19:04:06.024541 [debug] [Thread-1 (]: Finished running node model.retail.report_product_invoices
[0m19:04:06.025767 [debug] [Thread-1 (]: Began running node model.retail.report_year_invoices
[0m19:04:06.026818 [info ] [Thread-1 (]: 3 of 3 START sql table model retail.report_year_invoices ....................... [RUN]
[0m19:04:06.027936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.report_product_invoices, now model.retail.report_year_invoices)
[0m19:04:06.028711 [debug] [Thread-1 (]: Began compiling node model.retail.report_year_invoices
[0m19:04:06.032915 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.report_year_invoices"
[0m19:04:06.043493 [debug] [Thread-1 (]: Began executing node model.retail.report_year_invoices
[0m19:04:06.046961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:06.748011 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.report_year_invoices"
[0m19:04:06.756568 [debug] [Thread-1 (]: On model.retail.report_year_invoices: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.report_year_invoices"} */

  
    

    create or replace table `airflow-tutorial-437816`.`retail`.`report_year_invoices`
      
    
    

    OPTIONS()
    as (
      -- report_year_invoices.sql
SELECT
  dt.year,
  dt.month,
  COUNT(DISTINCT fi.invoice_id) AS num_invoices,
  SUM(fi.total) AS total_revenue
FROM `airflow-tutorial-437816`.`retail`.`fct_invoices` fi
JOIN `airflow-tutorial-437816`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id
GROUP BY dt.year, dt.month
ORDER BY dt.year, dt.month
    );
  
[0m19:04:07.356774 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=airflow-tutorial-437816&j=bq:US:e2459bef-204a-4cdf-8720-89fde55a62fc&page=queryresults
[0m19:04:10.295507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8aebbdc-5277-4146-9172-a0d70d7fb3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef277840e0>]}
[0m19:04:10.297289 [info ] [Thread-1 (]: 3 of 3 OK created sql table model retail.report_year_invoices .................. [[32mCREATE TABLE (13.0 rows, 12.4 MiB processed)[0m in 4.27s]
[0m19:04:10.298937 [debug] [Thread-1 (]: Finished running node model.retail.report_year_invoices
[0m19:04:10.302822 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:04:10.308174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:10.308824 [debug] [MainThread]: Connection 'model.retail.report_year_invoices' was properly closed.
[0m19:04:10.309926 [info ] [MainThread]: 
[0m19:04:10.311227 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 14.61 seconds (14.61s).
[0m19:04:10.314556 [debug] [MainThread]: Command end result
[0m19:04:10.383077 [info ] [MainThread]: 
[0m19:04:10.384163 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:04:10.385470 [info ] [MainThread]: 
[0m19:04:10.386926 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:04:10.388997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.675764, "process_user_time": 4.320457, "process_kernel_time": 1.052289, "process_mem_max_rss": "236920", "process_in_blocks": "54328", "process_out_blocks": "0"}
[0m19:04:10.390267 [debug] [MainThread]: Command `dbt run` succeeded at 19:04:10.390077 after 17.68 seconds
[0m19:04:10.391077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef7a25d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef56d150d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef79ce0d40>]}
[0m19:04:10.391896 [debug] [MainThread]: Flushing usage events
